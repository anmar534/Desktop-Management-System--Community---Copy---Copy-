# ØªÙ‚Ø±ÙŠØ± ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ ÙˆÙ…Ø­Ø¯Ø« Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¹ÙŠØ±

## Comprehensive Pricing System Analysis Report v2.0

**Ø§Ù„ØªØ§Ø±ÙŠØ®**: 5 Ù†ÙˆÙÙ…Ø¨Ø± 2025
**Ø§Ù„Ù†Ø³Ø®Ø©**: 2.0 (ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„)
**Ø§Ù„Ù…Ø­Ù„Ù„**: Claude Code Agent
**Ø§Ù„ØºØ±Ø¶**: ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¹ÙŠØ±ØŒ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ØŒ ÙˆØ®Ø·Ø© ØªØ·ÙˆÙŠØ± Ù…ØªÙƒØ§Ù…Ù„Ø©

---

## ğŸ“‹ Ø§Ù„ÙÙ‡Ø±Ø³

1. [Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ](#Ø§Ù„Ù…Ù„Ø®Øµ-Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ)
2. [Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ](#Ø­Ø§Ù„Ø©-Ø§Ù„Ù†Ø¸Ø§Ù…-Ø§Ù„Ø­Ø§Ù„ÙŠ)
3. [Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ](#Ø§Ù„ØªØ­Ù„ÙŠÙ„-Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ)
4. [Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ©](#Ø§Ù„Ù…Ø´Ø§ÙƒÙ„-Ø§Ù„Ù…ÙƒØªØ´ÙØ©)
5. [Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©](#Ù†Ù‚Ø§Ø·-Ø§Ù„Ù‚ÙˆØ©)
6. [Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø®Ø·Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©](#Ø§Ù„ØªÙˆØµÙŠØ§Øª-ÙˆØ§Ù„Ø®Ø·Ø©-Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©)
7. [Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©](#Ø®Ø·Ø©-Ø§Ù„ØªÙ†ÙÙŠØ°-Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©)
8. [Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ù„Ù„ØªÙ†Ø¸ÙŠÙ](#Ø§Ù„Ù…Ù„ÙØ§Øª-Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©-Ù„Ù„ØªÙ†Ø¸ÙŠÙ)

---

## ğŸ¯ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ

### Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ù…: âš ï¸ **7/10** (ØªØ­Ø³Ù† Ù…Ù† 6/10)

#### Ø§Ù„Ø­Ø§Ù„Ø©:

Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ÙˆØ¸ÙŠÙÙŠ ÙˆÙ„ÙƒÙ† ÙŠØ¹Ø§Ù†ÙŠ Ù…Ù† **ØªØ¹Ù‚ÙŠØ¯ Ù…Ø¹Ù…Ø§Ø±ÙŠ** Ù†ØªÙŠØ¬Ø© ÙˆØ¬ÙˆØ¯ Ø·Ø¨Ù‚Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© ÙˆØ£ÙƒÙˆØ§Ø¯ Ù‚Ø¯ÙŠÙ…Ø©.

#### Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:

1. âœ… **Ø¥Ø²Ø§Ù„Ø© Hooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©** (2 files)
2. âœ… **ØªÙˆØ­ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª** (Zustand Store)
3. âœ… **ØªØ¨Ø³ÙŠØ· Ø§Ù„Ø·Ø¨Ù‚Ø§Øª** (ØªÙ‚Ù„ÙŠÙ„ Ù…Ù† 5 Ø·Ø¨Ù‚Ø§Øª Ø¥Ù„Ù‰ 3)
4. âœ… **Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø±** (3 Ø·Ø±Ù‚ Ø­ÙØ¸ â†’ 1)
5. âš ï¸ **Ø¥Ø²Ø§Ù„Ø©/Ø¯Ù…Ø¬ Store ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…** (pricingWizardStore)

---

## ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ

### 1. Zustand Stores (Ø­Ø§Ù„Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø©)

#### âœ… `tenderPricingStore` (486 lines) - **Ù†Ø´Ø· ÙˆÙ…Ø³ØªØ®Ø¯Ù…**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [src/stores/tenderPricingStore.ts](src/stores/tenderPricingStore.ts)

**Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:**

- âœ… DevTools integration
- âœ… Persist middleware (localStorage)
- âœ… Immer for immutability
- âœ… Computed values (getTotalValue, getPricedItemsCount)
- âœ… Type-safe
- âœ… Optimized selectors

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

- âœ… TenderPricingPage.tsx (Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
- âœ… 4 selectors exported

**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… **Ù…Ù…ØªØ§Ø² - ÙŠØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø©**

---

#### âš ï¸ `pricingWizardStore` (545 lines) - **ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [src/application/stores/pricingWizardStore.ts](src/application/stores/pricingWizardStore.ts)

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

- âŒ ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (3 test files)
- âŒ Ù„Ø§ ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø£ÙŠ Ù…ÙƒÙˆÙ† ÙØ¹Ù„ÙŠ
- âŒ Wizard-based approach Ù„Ù… ÙŠÙØ·Ø¨Ù‚

**Ø§Ù„ØªÙˆØµÙŠØ©:** ğŸ—‘ï¸ **Ø­Ø°Ù Ø£Ùˆ Ø¯Ù…Ø¬ Ù…Ø¹ tenderPricingStore**

**Ø§Ù„Ø³Ø¨Ø¨:**

- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙŠØ³ØªØ®Ø¯Ù… Ù†Ù‡Ø¬ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© (TenderPricingPage) Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† wizard
- Ø§Ù„ØªÙƒØ±Ø§Ø± ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚ ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Bundle Size Ø¨Ø¯ÙˆÙ† ÙØ§Ø¦Ø¯Ø©

---

### 2. Legacy Hooks (Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©)

#### âŒ `useUnifiedTenderPricing` (180 lines) - **Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù…ÙƒØ§Ù†ÙŠÙ† ÙÙ‚Ø·**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [src/application/hooks/useUnifiedTenderPricing.ts](src/application/hooks/useUnifiedTenderPricing.ts)

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

```typescript
// âŒ TenderDetails.tsx (line 113)
const unified = useUnifiedTenderPricing(tender)

// âŒ useTenderDetails.ts (line 42)
const unified = useUnifiedTenderPricing(tender)
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:**

- âœ… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙŠÙ‚ÙˆÙ„ ÙŠØ¬Ø¨ Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ (tenderPricingStore.ts line 5)
- âŒ Ù„Ø§ ØªØ²Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ 2 Ù…Ù„ÙØ§Øª
- âŒ ØªØ¶Ø§Ø±Ø¨ Ù…Ø¹ Zustand Store
- âŒ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† BOQ Ù…Ø¨Ø§Ø´Ø±Ø© (ØªØ¬Ø§ÙˆØ² Store)

**Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡:**

- Bundle Size: ~6 KB
- Re-renders: Ø¹Ø§Ù„ÙŠ (no optimization)
- Maintenance Cost: Ù…ØªÙˆØ³Ø·

---

#### âš ï¸ `useEditableTenderPricing` (171 lines) - **Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙ„ÙƒÙ† ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [src/application/hooks/useEditableTenderPricing.ts](src/application/hooks/useEditableTenderPricing.ts)

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

- âŒ Ù„Ø§ ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø£ÙŠ Ù…Ù„Ù Ù†Ø´Ø· (ÙÙ‚Ø· ÙÙŠ archive/)
- âŒ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ `pricingStorageAdapter` (Ù†Ø¸Ø§Ù… drafts Ù‚Ø¯ÙŠÙ…)
- âŒ Ù…Ù†Ø·Ù‚ Ù…Ø¹Ù‚Ø¯ (official vs draft)

**Ø§Ù„ØªÙˆØµÙŠØ©:** ğŸ—‘ï¸ **Ø­Ø°Ù ÙÙˆØ±ÙŠ**

**Ø§Ù„Ø³Ø¨Ø¨:**

- Draft system ØªÙ… Ø¥Ù„ØºØ§Ø¤Ù‡
- Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª ÙØ¹Ù„ÙŠØ©
- Ø²ÙŠØ§Ø¯Ø© ÙÙŠ Bundle Size

---

### 3. Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Sources)

#### Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Sources (5 layers!)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Zustand Store (tenderPricingStore)      â”‚
â”‚     â””â”€ localStorage persistence             â”‚
â”‚                                             â”‚
â”‚  2. pricingService                          â”‚
â”‚     â””â”€ Thin wrapper over PricingStorage     â”‚
â”‚                                             â”‚
â”‚  3. pricingDataRepository                   â”‚
â”‚     â””â”€ Repository pattern                   â”‚
â”‚                                             â”‚
â”‚  4. tenderPricingRepository (Facade)        â”‚
â”‚     â””â”€ Delegates to pricingOrchestrator     â”‚
â”‚                                             â”‚
â”‚  5. pricingOrchestrator                     â”‚
â”‚     â””â”€ Coordinates multiple repositories    â”‚
â”‚                                             â”‚
â”‚  âœ… Actual Storage: electron-store          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:

**ğŸ”´ Too Many Layers = Complexity**

- âŒ 5 Ø·Ø¨Ù‚Ø§Øª Ù„Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!
- âŒ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª Ù…ØªØ¯Ø§Ø®Ù„Ø©
- âŒ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„ØµÙŠØ§Ù†Ø©
- âŒ Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø­Ø¯ÙˆØ« ØªØ¶Ø§Ø±Ø¨

#### Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¶Ø§Ø±Ø¨:

```typescript
// ÙÙŠ TenderPricingPage.tsx - 3 Ø·Ø±Ù‚ Ù…Ø®ØªÙ„ÙØ© Ù„Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨!

// 1ï¸âƒ£ saveDefaultPercentages (line 299)
await pricingService.saveTenderPricing(tender.id, {
  pricing: currentPricingData?.pricing || [],
  defaultPercentages: newPercentages, // âœ… Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨
})

// 2ï¸âƒ£ applyDefaultPercentagesToExistingItems (line 461)
await pricingService.saveTenderPricing(tender.id, {
  pricing: Array.from(updatedPricingData.entries()),
  defaultPercentages, // âœ… Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!
})

// 3ï¸âƒ£ persistPricingAndBOQ (line 285)
await tenderPricingRepository.persistPricingAndBOQ(
  tender.id,
  updatedPricingData,
  quantityItems,
  defaultPercentages, // âœ… Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø±Ø© Ø«Ø§Ù„Ø«Ø©!
)
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:**

- âŒ ØªÙƒØ±Ø§Ø± ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚
- âŒ Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø¹Ø¯Ù… ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âŒ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØµÙŠØ§Ù†Ø©

---

### 4. Ø§Ø³ØªØ®Ø¯Ø§Ù… Zustand Store ÙÙŠ TenderPricingPage

#### Ù…Ø§ ÙŠÙØ³ØªØ®Ø¯Ù… Ù…Ù† Store:

```typescript
// TenderPricingPage.tsx (line 66-72)
const {
  boqItems, // âœ… ÙŠÙØ³ØªØ®Ø¯Ù… - Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù†ÙˆØ¯
  loadPricing, // âœ… ÙŠÙØ³ØªØ®Ø¯Ù… - ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  savePricing, // âš ï¸ ÙŠÙØ³ØªØ®Ø¯Ù… Ù„ÙƒÙ† ÙŠØ³ØªØ¯Ø¹ÙŠ Repository
  isDirty, // âœ… ÙŠÙØ³ØªØ®Ø¯Ù… - ØªØªØ¨Ø¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
  markDirty, // âœ… ÙŠÙØ³ØªØ®Ø¯Ù… - ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© ØªØºÙŠÙŠØ±
} = useTenderPricingStore()
```

#### Ù…Ø§ Ù„Ø§ ÙŠÙØ³ØªØ®Ø¯Ù… Ù…Ù† Store:

```typescript
// Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Store Ù„ÙƒÙ† TenderPricingPage Ù„Ø§ ÙŠØ³ØªØ®Ø¯Ù…Ù‡Ø§

pricingData // âŒ Page ÙŠØ³ØªØ®Ø¯Ù… local state Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†Ù‡ (line 63)
defaultPercentages // âŒ Page ÙŠØ³ØªØ®Ø¯Ù… usePricingForm Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†Ù‡
currentItemIndex // âŒ Page ÙŠØ³ØªØ®Ø¯Ù… useTenderPricingState
currentPricing // âŒ Page ÙŠØ³ØªØ®Ø¯Ù… usePricingForm
```

#### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:

**ğŸ”´ Duplication Ø¨ÙŠÙ† Store Ùˆ Local State**

```typescript
// âŒ Local state ÙÙŠ TenderPricingPage
const [pricingData, setPricingData] = useState<Map<string, PricingData>>(new Map())

// âš ï¸ Store ÙÙŠÙ‡ Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙƒÙ† Ù„Ø§ ØªÙØ³ØªØ®Ø¯Ù…
// ÙÙŠ tenderPricingStore.ts
pricingData: new Map<string, PricingData>()
```

**Ø§Ù„Ø³Ø¨Ø¨:**

- Page ÙŠÙØ­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† `pricingService` Ù…Ø¨Ø§Ø´Ø±Ø© (line 354)
- ÙŠØªØ¬Ø§ÙˆØ² Store Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
- Store ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙ‚Ø· Ù„Ù€ BOQ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ

**Ø§Ù„ØªÙˆØµÙŠØ©:**

- Ù†Ù‚Ù„ `pricingData` Ù…Ù† local state Ø¥Ù„Ù‰ Store
- Ø§Ø³ØªØ®Ø¯Ø§Ù… Store ÙƒÙ€ **Single Source of Truth**

---

## ğŸ—ï¸ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ

### Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (As-Is):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Presentation Layer (UI)                  â”‚
â”‚                                                   â”‚
â”‚  â€¢ TenderPricingPage.tsx                         â”‚
â”‚    â”œâ”€ Local State (pricingData)                  â”‚
â”‚    â”œâ”€ usePricingForm (defaultPercentages)        â”‚
â”‚    â””â”€ Multiple custom hooks (10+)               â”‚
â”‚                                                   â”‚
â”‚  â€¢ TenderDetails.tsx                             â”‚
â”‚    â””â”€ useUnifiedTenderPricing âŒ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                      â”‚
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Zustand Store  â”‚   â”‚  Legacy Hooks    â”‚
â”‚  (Partial Use)  â”‚   â”‚  (Old System)    â”‚
â”‚                 â”‚   â”‚                  â”‚
â”‚ â€¢ loadPricing   â”‚   â”‚ â€¢ usePricingForm â”‚
â”‚ â€¢ savePricing   â”‚   â”‚ â€¢ useValidation  â”‚
â”‚ â€¢ boqItems      â”‚   â”‚ â€¢ useNavigation  â”‚
â”‚ â€¢ isDirty       â”‚   â”‚ â€¢ useUnified âŒ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Repository Layer       â”‚
        â”‚  (Facade Pattern)       â”‚
        â”‚                         â”‚
        â”‚  â€¢ TenderPricingRepo    â”‚
        â”‚    â””â”€> Orchestrator     â”‚
        â”‚         â”œâ”€> PricingRepo â”‚
        â”‚         â”œâ”€> BOQSyncRepo â”‚
        â”‚         â””â”€> StatusRepo  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Service Layer          â”‚
        â”‚                         â”‚
        â”‚  â€¢ pricingService       â”‚
        â”‚    (Thin wrapper)       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Storage Layer          â”‚
        â”‚                         â”‚
        â”‚  â€¢ PricingStorage       â”‚
        â”‚  â€¢ electron-store       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ØªØ¹Ù„ÙŠÙ‚:**

- âŒ 6 Ø·Ø¨Ù‚Ø§Øª!
- âŒ Store + Repository Ù…Ø¹Ø§Ù‹ = Confusion
- âŒ Local State + Store State = Duplication
- âŒ Legacy Hooks + New Store = Conflict

---

### Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© (To-Be):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Presentation Layer (UI)                  â”‚
â”‚                                                   â”‚
â”‚  â€¢ TenderPricingPage.tsx                         â”‚
â”‚    â””â”€ useTenderPricingStore() ONLY               â”‚
â”‚                                                   â”‚
â”‚  â€¢ TenderDetails.tsx                             â”‚
â”‚    â””â”€ useTenderPricingStore() selectors          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Zustand Store          â”‚
        â”‚  (Single Source)        â”‚
        â”‚                         â”‚
        â”‚  â€¢ All pricing state    â”‚
        â”‚  â€¢ All BOQ state        â”‚
        â”‚  â€¢ Computed values      â”‚
        â”‚  â€¢ Actions              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Service Layer          â”‚
        â”‚  (Simple Facade)        â”‚
        â”‚                         â”‚
        â”‚  â€¢ pricingService       â”‚
        â”‚    (CRUD only)          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Storage Layer          â”‚
        â”‚                         â”‚
        â”‚  â€¢ PricingStorage       â”‚
        â”‚  â€¢ electron-store       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ø§Ù„ÙÙˆØ§Ø¦Ø¯:**

- âœ… 3 Ø·Ø¨Ù‚Ø§Øª ÙÙ‚Ø· (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 6)
- âœ… Single Source of Truth (Store)
- âœ… No duplication
- âœ… Clear responsibilities
- âœ… Easy to test
- âœ… Better performance

---

## âŒ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ© (Ù…Ø±ØªØ¨Ø© Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©)

### ğŸ”´ **Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø±Ø¬Ø© (Critical)**

#### **1. Hooks Ù‚Ø¯ÙŠÙ…Ø© Ù„Ø§ ØªØ²Ø§Ù„ Ù…Ø³ØªØ®Ø¯Ù…Ø©**

**Ø§Ù„Ù…Ù„ÙØ§Øª:**

- [src/application/hooks/useUnifiedTenderPricing.ts](src/application/hooks/useUnifiedTenderPricing.ts) (180 lines)
- [src/application/hooks/useEditableTenderPricing.ts](src/application/hooks/useEditableTenderPricing.ts) (171 lines)

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª:**

```typescript
// âŒ TenderDetails.tsx
import { useUnifiedTenderPricing } from '@/application/hooks/useUnifiedTenderPricing'
const unified = useUnifiedTenderPricing(tender)

// âŒ useTenderDetails.ts
import { useUnifiedTenderPricing } from '@/application/hooks/useUnifiedTenderPricing'
const unified = useUnifiedTenderPricing(tender)
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âŒ ØªØ¶Ø§Ø±Ø¨ Ù…Ø¹ Zustand Store
- âŒ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙƒØ±Ø±
- âŒ Re-renders ØºÙŠØ± Ø¶Ø±ÙˆØ±ÙŠØ©
- âŒ Bundle size: ~12 KB

**Ø§Ù„Ø­Ù„:**

```typescript
// âœ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¨Ù€ Store selectors
import { useTenderPricingStore } from '@/stores/tenderPricingStore'

// Get specific data
const boqItems = useTenderPricingStore((state) => state.boqItems)
const totalValue = useTenderPricingStore((state) => state.getTotalValue())

// Or use existing selectors
import { useTenderPricingProgress } from '@/stores/tenderPricingStore'
const { pricedItems, totalItems, percentage } = useTenderPricingProgress()
```

---

#### **2. Duplication Ø¨ÙŠÙ† Store Ùˆ Local State**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [TenderPricingPage.tsx:63](src/presentation/pages/Tenders/TenderPricingPage.tsx#L63)

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ:**

```typescript
// âŒ Local state
const [pricingData, setPricingData] = useState<Map<string, PricingData>>(new Map())

// âš ï¸ Store has same data but not used
const { boqItems } = useTenderPricingStore() // ÙÙ‚Ø· boqItems
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:**

- Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…ÙƒØ§Ù†ÙŠÙ†
- Ø¹Ø¯Ù… ØªØ²Ø§Ù…Ù† Ù…Ø­ØªÙ…Ù„
- Ø²ÙŠØ§Ø¯Ø© ÙÙŠ memory usage

**Ø§Ù„Ø­Ù„:**

```typescript
// âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Store ÙÙ‚Ø·
const {
  pricingData, // Ù…Ù† Store
  updateItemPricing, // Ù…Ù† Store
  boqItems, // Ù…Ù† Store
} = useTenderPricingStore()
```

---

#### **3. ØªÙƒØ±Ø§Ø± Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­ÙØ¸ (3 Ø·Ø±Ù‚!)**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [TenderPricingPage.tsx](src/presentation/pages/Tenders/TenderPricingPage.tsx)

**Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ÙƒØ±Ø±Ø©:**

```typescript
// 1ï¸âƒ£ saveDefaultPercentages (line 299-312)
const saveDefaultPercentages = async (newPercentages) => {
  setDefaultPercentages(newPercentages)
  const currentPricingData = await pricingService.loadTenderPricing(tender.id)
  await pricingService.saveTenderPricing(tender.id, {
    pricing: currentPricingData?.pricing || [],
    defaultPercentages: newPercentages, // â† Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨
  })
}

// 2ï¸âƒ£ applyDefaultPercentagesToExistingItems (line 400-497)
await pricingService.saveTenderPricing(tender.id, {
  pricing: Array.from(updatedPricingData.entries()),
  defaultPercentages, // â† Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!
})

// 3ï¸âƒ£ persistPricingAndBOQ (line 278-296)
await tenderPricingRepository.persistPricingAndBOQ(
  tender.id,
  updatedPricingData,
  quantityItems,
  defaultPercentages, // â† Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø¨ Ù…Ø±Ø© Ø«Ø§Ù„Ø«Ø©!
)
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âŒ 3 Ù…Ø³Ø§Ø±Ø§Øª Ù„Ø­ÙØ¸ Ù†ÙØ³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âŒ Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø¹Ø¯Ù… ØªØ²Ø§Ù…Ù†
- âŒ ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØµÙŠØ§Ù†Ø©
- âŒ ÙƒÙˆØ¯ Ù…ÙƒØ±Ø± (~150 lines)

**Ø§Ù„Ø­Ù„:**

```typescript
// âœ… Ø·Ø±ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Store
const { saveDefaultPercentages } = useTenderPricingStore()

// Implementation ÙÙŠ Store
saveDefaultPercentages: async (tenderId, percentages) => {
  // Single source of truth
  await pricingService.updateDefaultPercentages(tenderId, percentages)
  set((state) => {
    state.defaultPercentages = percentages
    state.isDirty = true
  })
}
```

---

### ğŸŸ¡ **Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ© (High)**

#### **4. Ø·Ø¨Ù‚Ø§Øª Ø²Ø§Ø¦Ø¯Ø© (Over-engineering)**

**Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ:**

```
TenderPricingPage
  â†’ useTenderPricingStore
    â†’ tenderPricingRepository
      â†’ pricingOrchestrator
        â†’ pricingDataRepository
          â†’ pricingService
            â†’ PricingStorage
              â†’ electron-store
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:**

- 8 Ø®Ø·ÙˆØ§Øª Ù„Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!
- ÙƒÙ„ Ø·Ø¨Ù‚Ø© ØªØ¶ÙŠÙ overhead
- ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„ØªØµØ­ÙŠØ­

**Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ù‚ØªØ±Ø­:**

```
TenderPricingPage
  â†’ useTenderPricingStore
    â†’ pricingService
      â†’ PricingStorage
        â†’ electron-store
```

**Ø§Ù„ØªØ¨Ø³ÙŠØ·:**

- Ø­Ø°Ù Repository layer (Ø£Ùˆ Ø¬Ø¹Ù„Ù‡ facade Ø¨Ø³ÙŠØ·)
- Ø­Ø°Ù Orchestrator (Ù…Ù†Ø·Ù‚ ÙÙŠ Store)
- Direct call Ù…Ù† Store Ø¥Ù„Ù‰ Service

---

#### **5. pricingWizardStore ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [src/application/stores/pricingWizardStore.ts](src/application/stores/pricingWizardStore.ts) (545 lines)

**Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:**

- âŒ ÙÙ‚Ø· ÙÙŠ test files (3 files)
- âŒ Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙØ¹Ù„ÙŠ ÙÙŠ UI
- âŒ Wizard approach Ù„Ù… ÙŠÙØ·Ø¨Ù‚

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- Bundle size: ~18 KB
- Maintenance cost: Ù…ØªÙˆØ³Ø·
- Confusion: Ø¹Ø§Ù„ÙŠ (Ø£ÙŠ store Ù†Ø³ØªØ®Ø¯Ù…ØŸ)

**Ø§Ù„Ø­Ù„:**

**Ø§Ù„Ø®ÙŠØ§Ø± 1: Ø­Ø°Ù ÙƒØ§Ù…Ù„**

```bash
# Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… wizard
rm src/application/stores/pricingWizardStore.ts
rm tests/application/stores/pricingWizardStore.test.ts
```

**Ø§Ù„Ø®ÙŠØ§Ø± 2: Ø¯Ù…Ø¬ Ù…Ø¹ tenderPricingStore**

```typescript
// Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ù…ÙŠØ²Ø§Øª Ù…ÙÙŠØ¯Ø©
// Ù†Ù‚Ù„ validation logic Ùˆ step management Ø¥Ù„Ù‰ tenderPricingStore
```

**Ø§Ù„ØªÙˆØµÙŠØ©:** Ø­Ø°Ù (Wizard ØºÙŠØ± Ù…Ø®Ø·Ø·)

---

### ğŸŸ¢ **Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø© (Medium)**

#### **6. Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Store selectors Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„**

**Ø§Ù„Ù…ØªØ§Ø­:**

```typescript
// Selectors Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ tenderPricingStore.ts
export const useTenderPricingValue = () => useTenderPricingStore((state) => state.getTotalValue())

export const useTenderPricingProgress = () =>
  useTenderPricingStore((state) => ({
    pricedItems: state.getPricedItemsCount(),
    totalItems: state.boqItems.length,
    percentage: state.getCompletionPercentage(),
  }))

export const useItemPricing = (itemId: string) =>
  useTenderPricingStore((state) => state.pricingData.get(itemId))

export const useTenderPricingStatus = () =>
  useTenderPricingStore((state) => ({
    isLoading: state.isLoading,
    isDirty: state.isDirty,
    error: state.error,
    lastSaved: state.lastSaved,
  }))
```

**Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:**

- âŒ Ù„Ø§ ÙŠÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù†!
- ÙÙ‚Ø· exported Ù„ÙƒÙ† Ù„Ø§ imports

**Ø§Ù„ØªÙˆØµÙŠØ©:**

- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù€ selectors ÙÙŠ TenderDetails
- Ø§Ø³ØªØ¨Ø¯Ø§Ù„ useUnifiedTenderPricing Ø¨Ù€ selectors

---

#### **7. ØªØ­Ù…ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± Ù…Ù† pricingService (ØªØ¬Ø§ÙˆØ² Store)**

**Ø§Ù„Ù…ÙˆÙ‚Ø¹:** [TenderPricingPage.tsx:346-395](src/presentation/pages/Tenders/TenderPricingPage.tsx#L346)

**Ø§Ù„ÙƒÙˆØ¯:**

```typescript
useEffect(() => {
  const loaded = await pricingService.loadTenderPricing(tender.id)
  if (loaded && loaded.pricing) {
    const pricingMap = new Map(loaded.pricing)
    setPricingData(pricingMap) // â† Local state!

    if (loaded.defaultPercentages) {
      setDefaultPercentages(loaded.defaultPercentages)
    }
  }
}, [tender.id])
```

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:**

- ØªØ¬Ø§ÙˆØ² Store
- Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ local state
- no single source of truth

**Ø§Ù„Ø­Ù„:**

```typescript
// âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Store action
useEffect(() => {
  loadPricing(tender.id) // Ù…Ù† Store
}, [tender.id, loadPricing])

// Store ÙŠÙØ­Ù…Ù‘Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙŠØ­ÙØ¸Ù‡Ø§ ÙÙŠ state
```

---

## âœ… Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©

### 1. Zustand Store Implementation

**ØªÙ‚ÙŠÙŠÙ…:** â­â­â­â­â­ (Ù…Ù…ØªØ§Ø²)

```typescript
// tenderPricingStore.ts
export const useTenderPricingStore = create<TenderPricingState>()(
  devtools(          // âœ… DevTools
    persist(         // âœ… Persistence
      immer(...)     // âœ… Immutability
    )
  )
)
```

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**

- DevTools integration Ù„Ù„ØªØµØ­ÙŠØ­
- Automatic persistence
- Immutable updates (Immer)
- Type-safe
- Computed values
- Optimized selectors

---

### 2. PricingStorage Optimization

**ØªÙ‚ÙŠÙŠÙ…:** â­â­â­â­ (Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹)

```typescript
// PricingStorage.ts
async saveTenderPricing(tenderId, payload) {
  // âœ… Skip if no change
  const isSame = normalize(previous) === normalize(data)
  if (!isSame) {
    await this.manager.set(STORAGE_KEYS.PRICING_DATA, store)
  }
}
```

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**

- ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
- ØªÙ‚Ù„ÙŠÙ„ I/O operations
- Normalization Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©

---

### 3. Type Safety

**ØªÙ‚ÙŠÙŠÙ…:** â­â­â­â­ (Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹)

```typescript
// Strong typing ÙÙŠ ÙƒÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
interface PricingData { ... }
interface PricingPercentages { ... }
interface TenderPricingState { ... }
```

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**

- Compile-time type checking
- Better IDE support
- Fewer runtime errors

---

### 4. Repository Pattern (Ø§Ù„ÙÙƒØ±Ø© Ø¬ÙŠØ¯Ø©)

**ØªÙ‚ÙŠÙŠÙ…:** â­â­â­ (Ø¬ÙŠØ¯ Ù„ÙƒÙ† over-engineered)

```typescript
// Clean separation
PricingDataRepository // Data access
BOQSyncRepository // BOQ sync
TenderStatusRepository // Status updates
PricingOrchestrator // Coordination
```

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**

- Separation of concerns
- Testability
- Maintainability

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:**

- Too many layers
- ÙŠÙ…ÙƒÙ† ØªØ¨Ø³ÙŠØ·Ù‡

---

## ğŸ“‹ Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø®Ø·Ø© Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙÙˆØ±ÙŠ (Week 1) - **Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø±Ø¬Ø©**

#### 1.1 Ø­Ø°Ù useUnifiedTenderPricing

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©:**

```
src/application/hooks/useUnifiedTenderPricing.ts
src/presentation/components/tenders/TenderDetails.tsx
src/presentation/components/tenders/TenderDetails/hooks/useTenderDetails.ts
tests/pricing/unifiedTenderPricing.test.ts
```

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

**Ø£) ØªØ­Ø¯ÙŠØ« TenderDetails.tsx:**

```typescript
// âŒ Ù‚Ø¨Ù„
import { useUnifiedTenderPricing } from '@/application/hooks/useUnifiedTenderPricing'
const unified = useUnifiedTenderPricing(tender)
const items = unified.items
const totals = unified.totals

// âœ… Ø¨Ø¹Ø¯
import { useTenderPricingStore, useTenderPricingProgress } from '@/stores/tenderPricingStore'

// ÙÙŠ Ø§Ù„Ù…ÙƒÙˆÙ†
const { boqItems, loadPricing } = useTenderPricingStore()
const { pricedItems, totalItems, percentage } = useTenderPricingProgress()
const totalValue = useTenderPricingStore((state) => state.getTotalValue())

// Load on mount
useEffect(() => {
  if (tender?.id) {
    loadPricing(tender.id)
  }
}, [tender?.id, loadPricing])

// Use boqItems directly
const items = boqItems
```

**Ø¨) ØªØ­Ø¯ÙŠØ« useTenderDetails.ts:**

Ù†ÙØ³ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡

**Ø¬) Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØ§Øª:**

```bash
# Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„Ø¨Ø¯ÙŠÙ„
git rm src/application/hooks/useUnifiedTenderPricing.ts
git rm tests/pricing/unifiedTenderPricing.test.ts
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âœ… ØªÙ‚Ù„ÙŠÙ„ Bundle Size: ~6 KB
- âœ… Ø¥Ø²Ø§Ù„Ø© ØªØ¶Ø§Ø±Ø¨ Ù…Ø¹ Store
- âœ… Unified data source

---

#### 1.2 Ø­Ø°Ù useEditableTenderPricing

**Ø§Ù„Ù…Ù„Ù:** `src/application/hooks/useEditableTenderPricing.ts`

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

```bash
# Ù„Ø§ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª ÙØ¹Ù„ÙŠØ© - Ø­Ø°Ù Ù…Ø¨Ø§Ø´Ø±
git rm src/application/hooks/useEditableTenderPricing.ts
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âœ… ØªÙ‚Ù„ÙŠÙ„ Bundle Size: ~6 KB
- âœ… Ø¥Ø²Ø§Ù„Ø© draft system Ø§Ù„Ù‚Ø¯ÙŠÙ…
- âœ… ØªØ¨Ø³ÙŠØ· Ø§Ù„ÙƒÙˆØ¯

---

#### 1.3 Ø­Ø°Ù/Ø¯Ù…Ø¬ pricingWizardStore

**Ø§Ù„Ù…Ù„Ù:** `src/application/stores/pricingWizardStore.ts`

**Ø§Ù„Ù‚Ø±Ø§Ø±:** â“ ÙŠØ­ØªØ§Ø¬ ØªØ£ÙƒÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…

**Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø­Ø°Ù (Ù…ÙˆØµÙ‰ Ø¨Ù‡)**

```bash
# Ø¥Ø°Ø§ Ù„Ø§ Ø®Ø·Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… wizard approach
git rm src/application/stores/pricingWizardStore.ts
git rm tests/application/stores/pricingWizardStore.test.ts
```

**Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø¯Ù…Ø¬ (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ù…ÙŠØ²Ø§Øª Ù…ÙÙŠØ¯Ø©)**

```typescript
// ÙÙŠ tenderPricingStore.ts - Ø¥Ø¶Ø§ÙØ© validation logic
validateCurrentItem: () => {
  // Ù…Ù†Ø·Ù‚ Ù…Ù† pricingWizardStore
}
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âœ… ØªÙ‚Ù„ÙŠÙ„ Bundle Size: ~18 KB
- âœ… ØªÙˆØ­ÙŠØ¯ Store
- âœ… Clear architecture

---

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: ØªÙˆØ­ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Week 2) - **Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©**

#### 2.1 Ù†Ù‚Ù„ pricingData Ù…Ù† Local State Ø¥Ù„Ù‰ Store

**Ø§Ù„Ù…Ù„Ù:** `TenderPricingPage.tsx`

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

**Ø£) Ø¥Ø²Ø§Ù„Ø© local state:**

```typescript
// âŒ Ø­Ø°Ù
const [pricingData, setPricingData] = useState<Map<string, PricingData>>(new Map())

// âŒ Ø­Ø°Ù useEffect Ø§Ù„Ø°ÙŠ ÙŠØ­Ù…Ù„ Ù…Ù† pricingService (line 346)
useEffect(() => {
  const loaded = await pricingService.loadTenderPricing(tender.id)
  // ...
}, [tender.id])
```

**Ø¨) Ø§Ø³ØªØ®Ø¯Ø§Ù… Store:**

```typescript
// âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Store
const {
  pricingData, // Ù…Ù† Store Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† local state
  updateItemPricing, // Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† setPricingData
  defaultPercentages, // Ù…Ù† Store
  setDefaultPercentages,
} = useTenderPricingStore()
```

**Ø¬) ØªØ­Ø¯ÙŠØ« Store actions:**

```typescript
// ÙÙŠ tenderPricingStore.ts - ØªØ­Ø¯ÙŠØ« loadPricing
loadPricing: async (tenderId: string) => {
  // ØªØ­Ù…ÙŠÙ„ Ù…Ù† pricingService
  const loaded = await pricingService.loadTenderPricing(tenderId)

  // BOQ data
  const boqData = await boqRepo.getByTenderId(tenderId)

  set((state) => {
    // BOQ items
    state.boqItems = boqData?.items || []

    // Pricing data (Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©)
    if (loaded?.pricing) {
      state.pricingData = new Map(loaded.pricing)
    }

    // Default percentages
    if (loaded?.defaultPercentages) {
      state.defaultPercentages = loaded.defaultPercentages
    }
  })
}
```

**Ø§Ù„ØªØ£Ø«ÙŠØ±:**

- âœ… Single Source of Truth
- âœ… No duplication
- âœ… Easier state management

---

#### 2.2 ØªÙˆØ­ÙŠØ¯ defaultPercentages

**Ø§Ù„Ø­Ø§Ù„ÙŠ:**

```typescript
// âŒ ÙÙŠ usePricingForm
const {
  defaultPercentages,      // local state!
  setDefaultPercentages,
} = usePricingForm(...)
```

**Ø§Ù„Ø¬Ø¯ÙŠØ¯:**

```typescript
// âœ… Ù…Ù† Store
const { defaultPercentages, setDefaultPercentages } = useTenderPricingStore()
```

---

#### 2.3 ØªÙˆØ­ÙŠØ¯ Ø·Ø±Ù‚ Ø§Ù„Ø­ÙØ¸

**Ø­Ø°Ù:**

```typescript
// âŒ Ø­Ø°Ù saveDefaultPercentages (line 299)
// âŒ Ø­Ø°Ù applyDefaultPercentagesToExistingItems (line 400)
// âŒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ persistPricingAndBOQ Ø¨Ù€ Store action
```

**Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¨Ù€:**

```typescript
// âœ… Ø·Ø±ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙŠ Store
const { savePricing, saveDefaultPercentages } = useTenderPricingStore()

// Implementation ÙÙŠ Store
saveDefaultPercentages: async (percentages) => {
  const { currentTenderId } = get()

  // Ø­ÙØ¸ ÙÙŠ storage
  await pricingService.updateDefaultPercentages(currentTenderId, percentages)

  // ØªØ­Ø¯ÙŠØ« state
  set((state) => {
    state.defaultPercentages = percentages
    state.isDirty = true
  })
}
```

---

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: ØªØ¨Ø³ÙŠØ· Ø§Ù„Ø·Ø¨Ù‚Ø§Øª (Week 3) - **Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©**

#### 3.1 Ø§Ù„Ù‚Ø±Ø§Ø±: Repository Layer

**Ø§Ù„Ø®ÙŠØ§Ø± 1: Ø­Ø°Ù ÙƒØ§Ù…Ù„**

```typescript
// âŒ Ø­Ø°Ù
tenderPricingRepository
pricingOrchestrator
pricingDataRepository
boqSyncRepository
tenderStatusRepository

// âœ… Store ÙŠØ³ØªØ¯Ø¹ÙŠ Services Ù…Ø¨Ø§Ø´Ø±Ø©
savePricing: async () => {
  await pricingService.saveTenderPricing(...)
  await boqService.syncFromPricing(...)
  await tenderService.updateStatus(...)
}
```

**Ø§Ù„ÙÙˆØ§Ø¦Ø¯:**

- ØªØ¨Ø³ÙŠØ· (3 Ø·Ø¨Ù‚Ø§Øª Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 6)
- Ø£Ø³Ø±Ø¹
- Ø£Ù‚Ù„ maintenance

**Ø§Ù„Ø¹ÙŠÙˆØ¨:**

- Store ÙŠØµØ¨Ø­ Ø£ÙƒØ¨Ø±
- Ù…Ù†Ø·Ù‚ business ÙÙŠ Store

**Ø§Ù„Ø®ÙŠØ§Ø± 2: Ø¥Ø¨Ù‚Ø§Ø¡ ÙƒÙ€ Facade ÙÙ‚Ø· (Ù…ÙˆØµÙ‰ Ø¨Ù‡)**

```typescript
// âœ… TenderPricingRepository ÙƒÙ€ facade Ø¨Ø³ÙŠØ· (NO logic)
class TenderPricingRepository {
  async save(tenderId, data, percentages) {
    // Just delegate - no business logic
    await pricingService.saveTenderPricing(tenderId, data)
    await pricingService.updateDefaultPercentages(tenderId, percentages)
  }
}
```

**Ø§Ù„ÙÙˆØ§Ø¦Ø¯:**

- Separation of concerns
- Clean API
- Testable

**Ø§Ù„Ø¹ÙŠÙˆØ¨:**

- Ø·Ø¨Ù‚Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ù„ÙƒÙ† Ø¨Ø³ÙŠØ·Ø©)

**Ø§Ù„ØªÙˆØµÙŠØ©:** **Ø§Ù„Ø®ÙŠØ§Ø± 2** (Facade Ø¨Ø³ÙŠØ·)

---

#### 3.2 ØªØ¨Ø³ÙŠØ· pricingService

**Ø§Ù„Ø­Ø§Ù„ÙŠ:**

```typescript
// pricingService.ts (26 lines)
export const pricingService = {
  async loadTenderPricing(tenderId: string) {
    return pricingStorage.loadTenderPricing(tenderId)
  },
  // ...
}
```

**Ø§Ù„ØªØ­Ù„ÙŠÙ„:**

- âœ… Ø¨Ø³ÙŠØ· Ø¬Ø¯Ø§Ù‹
- âœ… thin wrapper
- âœ… ÙŠÙ…ÙƒÙ† Ø¥Ø¨Ù‚Ø§Ø¤Ù‡

**Ø§Ù„Ù‚Ø±Ø§Ø±:** **Ø¥Ø¨Ù‚Ø§Ø¡ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±** (Ø¬ÙŠØ¯ ÙƒÙ…Ø§ Ù‡Ùˆ)

---

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª (Week 4) - **Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©**

#### 4.1 Ø¥Ø¶Ø§ÙØ© Unit Tests Ù„Ù„Ù€ Store

**Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯:** `tests/unit/tenderPricingStore.test.ts`

```typescript
import { renderHook, act } from '@testing-library/react'
import { useTenderPricingStore } from '@/stores/tenderPricingStore'

describe('useTenderPricingStore', () => {
  beforeEach(() => {
    // Reset store
    const { result } = renderHook(() => useTenderPricingStore())
    act(() => {
      result.current.reset()
    })
  })

  it('should load pricing correctly', async () => {
    const { result } = renderHook(() => useTenderPricingStore())

    await act(async () => {
      await result.current.loadPricing('tender-123')
    })

    expect(result.current.boqItems).toHaveLength(5)
    expect(result.current.pricingData.size).toBeGreaterThan(0)
  })

  it('should save default percentages correctly', async () => {
    const { result } = renderHook(() => useTenderPricingStore())

    await act(async () => {
      await result.current.setDefaultPercentages({
        administrative: 10,
        operational: 5,
        profit: 8,
      })
    })

    expect(result.current.defaultPercentages).toEqual({
      administrative: 10,
      operational: 5,
      profit: 8,
    })
    expect(result.current.isDirty).toBe(true)
  })

  it('should calculate totals correctly', () => {
    const { result } = renderHook(() => useTenderPricingStore())

    // Setup test data
    act(() => {
      result.current.updateItemPricing('item-1', {
        unitPrice: 100,
        quantity: 10,
        totalPrice: 1000,
      })
    })

    expect(result.current.getTotalValue()).toBe(1000)
    expect(result.current.getPricedItemsCount()).toBe(1)
  })
})
```

---

#### 4.2 Integration Tests

**Ø§Ù„Ù…Ù„Ù:** `tests/integration/tender-pricing-full-flow.test.ts`

```typescript
describe('Tender Pricing Full Flow', () => {
  it('should complete full pricing workflow', async () => {
    // 1. Load tender
    // 2. Load pricing
    // 3. Update items
    // 4. Save percentages
    // 5. Save pricing
    // 6. Verify persistence
  })
})
```

---

## ğŸ—‚ï¸ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ© Ù„Ù„ØªÙ†Ø¸ÙŠÙ

### ğŸ“ Ù…Ù„ÙØ§Øª Ù„Ù„Ø­Ø°Ù (Delete)

#### Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø±Ø¬Ø©:

1. âœ… `src/application/hooks/useUnifiedTenderPricing.ts` (180 lines)

   - Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ 2 files ÙÙ‚Ø·
   - ÙŠØ¬Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ù€ Store selectors

2. âœ… `src/application/hooks/useEditableTenderPricing.ts` (171 lines)

   - ØºÙŠØ± Ù…Ø³ØªØ®Ø¯Ù…
   - Ù†Ø¸Ø§Ù… drafts Ù‚Ø¯ÙŠÙ…

3. âš ï¸ `src/application/stores/pricingWizardStore.ts` (545 lines)

   - Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ tests ÙÙ‚Ø·
   - wizard approach ØºÙŠØ± Ù…Ø·Ø¨Ù‚

4. âœ… `tests/pricing/unifiedTenderPricing.test.ts`
   - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ù„Ù„Ù€ hook Ø§Ù„Ù‚Ø¯ÙŠÙ…

#### Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©:

5. âš ï¸ `src/services/pricingStorageAdapter.ts` (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯)
   - draft system Ù‚Ø¯ÙŠÙ…

---

### ğŸ“ Ù…Ù„ÙØ§Øª Ù„Ù„ØªØ­Ø¯ÙŠØ« (Update)

#### Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø±Ø¬Ø©:

1. âœ… `src/presentation/pages/Tenders/TenderPricingPage.tsx`

   - Ø¥Ø²Ø§Ù„Ø© local state (pricingData)
   - ØªÙˆØ­ÙŠØ¯ Ø·Ø±Ù‚ Ø§Ù„Ø­ÙØ¸
   - Ø§Ø³ØªØ®Ø¯Ø§Ù… Store Ø¨Ø§Ù„ÙƒØ§Ù…Ù„

2. âœ… `src/presentation/components/tenders/TenderDetails.tsx`

   - Ø§Ø³ØªØ¨Ø¯Ø§Ù„ useUnifiedTenderPricing Ø¨Ù€ Store

3. âœ… `src/presentation/components/tenders/TenderDetails/hooks/useTenderDetails.ts`

   - Ø§Ø³ØªØ¨Ø¯Ø§Ù„ useUnifiedTenderPricing Ø¨Ù€ Store

4. âœ… `src/stores/tenderPricingStore.ts`
   - Ø¥Ø¶Ø§ÙØ© saveDefaultPercentages action
   - ØªØ­Ø³ÙŠÙ† loadPricing (ØªØ­Ù…ÙŠÙ„ pricing details)
   - Ø¥Ø¶Ø§ÙØ© updateDefaultPercentages action

#### Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©:

5. âš ï¸ `src/infrastructure/repositories/TenderPricingRepository.ts`

   - ØªØ¨Ø³ÙŠØ· (facade ÙÙ‚Ø·)

6. âš ï¸ `src/infrastructure/repositories/pricing/PricingOrchestrator.ts`
   - Ø¯Ù…Ø¬ Ù…Ù†Ø·Ù‚ ÙÙŠ Store Ø£Ùˆ ØªØ¨Ø³ÙŠØ·

---

### ğŸ†• Ù…Ù„ÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø© (New)

1. âœ… `tests/unit/tenderPricingStore.test.ts`

   - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù€ Store

2. âœ… `tests/integration/tender-pricing-full-flow.test.ts`

   - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª integration ÙƒØ§Ù…Ù„Ø©

3. âš ï¸ `docs/PRICING_SYSTEM_MIGRATION.md`
   - ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙˆØ§Ù„ØªØ±Ø­ÙŠÙ„

---

## ğŸ—“ï¸ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©

### Week 1: Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙÙˆØ±ÙŠ (5 Ø£ÙŠØ§Ù…)

| Ø§Ù„ÙŠÙˆÙ…     | Ø§Ù„Ù…Ù‡Ù…Ø©                            | Ø§Ù„Ù…Ù„ÙØ§Øª | Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø± |
| --------- | --------------------------------- | ------- | ------------ |
| **Day 1** | Ø­Ø°Ù useUnifiedTenderPricing       | 4 files | 4 hours      |
|           | âœ… ØªØ­Ø¯ÙŠØ« TenderDetails.tsx        |         | 1 hour       |
|           | âœ… ØªØ­Ø¯ÙŠØ« useTenderDetails.ts      |         | 1 hour       |
|           | âœ… Ø­Ø°Ù useUnifiedTenderPricing.ts |         | 0.5 hour     |
|           | âœ… Ø­Ø°Ù tests                      |         | 0.5 hour     |
|           | âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„                    |         | 1 hour       |
| **Day 2** | Ø­Ø°Ù useEditableTenderPricing      | 1 file  | 1 hour       |
|           | âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…        |         | 0.5 hour     |
|           | âœ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù                      |         | 0.5 hour     |
| **Day 3** | Ù‚Ø±Ø§Ø± pricingWizardStore           | 2 files | 3 hours      |
|           | â“ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙƒÙˆØ¯                   |         | 1 hour       |
|           | â“ Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± (Ø­Ø°Ù/Ø¯Ù…Ø¬)         |         | 0.5 hour     |
|           | âœ… ØªÙ†ÙÙŠØ° Ø§Ù„Ù‚Ø±Ø§Ø±                   |         | 1 hour       |
|           | âœ… Ø§Ø®ØªØ¨Ø§Ø±                         |         | 0.5 hour     |
| **Day 4** | ØªÙˆØ­ÙŠØ¯ Store exports               | -       | 2 hours      |
|           | âœ… Ø¥Ø¶Ø§ÙØ© selectors                |         | 1 hour       |
|           | âœ… ØªÙˆØ«ÙŠÙ‚                          |         | 1 hour       |
| **Day 5** | Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø®ØªØ¨Ø§Ø± Week 1             | -       | 4 hours      |
|           | âœ… Review ÙƒØ§Ù…Ù„                    |         | 2 hours      |
|           | âœ… Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª E2E                   |         | 2 hours      |

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**

- âœ… 2-3 hooks Ù‚Ø¯ÙŠÙ…Ø© Ù…Ø­Ø°ÙˆÙØ©
- âœ… ~25 KB ØªÙ‚Ù„ÙŠÙ„ ÙÙŠ Bundle Size
- âœ… Store selectors ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ø³ØªØ®Ø¯Ù…Ø©

---

### Week 2: ØªÙˆØ­ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (5 Ø£ÙŠØ§Ù…)

| Ø§Ù„ÙŠÙˆÙ…     | Ø§Ù„Ù…Ù‡Ù…Ø©                           | Ø§Ù„Ù…Ù„ÙØ§Øª               | Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø± |
| --------- | -------------------------------- | --------------------- | ------------ |
| **Day 1** | Ù†Ù‚Ù„ pricingData Ø¥Ù„Ù‰ Store        | TenderPricingPage.tsx | 6 hours      |
|           | âœ… Ø¥Ø²Ø§Ù„Ø© local state             |                       | 1 hour       |
|           | âœ… ØªØ­Ø¯ÙŠØ« Store actions           |                       | 3 hours      |
|           | âœ… ØªØ­Ø¯ÙŠØ« references              |                       | 2 hours      |
| **Day 2** | Ù†Ù‚Ù„ defaultPercentages Ø¥Ù„Ù‰ Store | TenderPricingPage.tsx | 4 hours      |
|           | âœ… Ø¥Ø²Ø§Ù„Ø© Ù…Ù† usePricingForm       |                       | 2 hours      |
|           | âœ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Store                 |                       | 2 hours      |
| **Day 3** | ØªÙˆØ­ÙŠØ¯ Ø·Ø±Ù‚ Ø§Ù„Ø­ÙØ¸                  | TenderPricingPage.tsx | 6 hours      |
|           | âœ… Ø­Ø°Ù saveDefaultPercentages    |                       | 1 hour       |
|           | âœ… Ø­Ø°Ù applyDefaultPercentages   |                       | 1 hour       |
|           | âœ… ØªØ­Ø¯ÙŠØ« persistPricingAndBOQ    |                       | 2 hours      |
|           | âœ… Ø¥Ø¶Ø§ÙØ© Store actions           |                       | 2 hours      |
| **Day 4** | ØªØ­Ø¯ÙŠØ« loadPricing                | tenderPricingStore.ts | 4 hours      |
|           | âœ… ØªØ­Ù…ÙŠÙ„ pricing details         |                       | 2 hours      |
|           | âœ… ØªØ­Ù…ÙŠÙ„ percentages             |                       | 1 hour       |
|           | âœ… Ø§Ø®ØªØ¨Ø§Ø±                        |                       | 1 hour       |
| **Day 5** | Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø®ØªØ¨Ø§Ø± Week 2            | -                     | 4 hours      |

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**

- âœ… Single Source of Truth
- âœ… Ø·Ø±ÙŠÙ‚Ø© Ø­ÙØ¸ ÙˆØ§Ø­Ø¯Ø©
- âœ… State management Ù…ÙˆØ­Ø¯

---

### Week 3: ØªØ¨Ø³ÙŠØ· Ø§Ù„Ø·Ø¨Ù‚Ø§Øª (5 Ø£ÙŠØ§Ù…)

| Ø§Ù„ÙŠÙˆÙ…       | Ø§Ù„Ù…Ù‡Ù…Ø©                           | Ø§Ù„Ù…Ù„ÙØ§Øª | Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø± |
| ----------- | -------------------------------- | ------- | ------------ |
| **Day 1**   | Ù…Ø±Ø§Ø¬Ø¹Ø© Repository Layer          | -       | 4 hours      |
|             | âœ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…               |         | 2 hours      |
|             | âœ… Ø§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±                  |         | 2 hours      |
| **Day 2-3** | ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ¨Ø³ÙŠØ·                    | 5 files | 8 hours      |
|             | âœ… ØªØ­Ø¯ÙŠØ« TenderPricingRepository |         | 2 hours      |
|             | âœ… ØªØ¨Ø³ÙŠØ· PricingOrchestrator     |         | 3 hours      |
|             | âœ… ØªØ­Ø¯ÙŠØ« Store calls             |         | 3 hours      |
| **Day 4**   | ØªÙˆØ«ÙŠÙ‚                            | docs/   | 3 hours      |
|             | âœ… Architecture diagram          |         | 1 hour       |
|             | âœ… Migration guide               |         | 2 hours      |
| **Day 5**   | Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ø®ØªØ¨Ø§Ø± Week 3            | -       | 4 hours      |

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**

- âœ… 3 Ø·Ø¨Ù‚Ø§Øª Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† 6
- âœ… Clear responsibilities
- âœ… ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„

---

### Week 4: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© (5 Ø£ÙŠØ§Ù…)

| Ø§Ù„ÙŠÙˆÙ…       | Ø§Ù„Ù…Ù‡Ù…Ø©              | Ø§Ù„Ù…Ù„ÙØ§Øª            | Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø± |
| ----------- | ------------------- | ------------------ | ------------ |
| **Day 1-2** | Unit Tests          | tests/unit/        | 8 hours      |
|             | âœ… Store tests      |                    | 4 hours      |
|             | âœ… Service tests    |                    | 2 hours      |
|             | âœ… Repository tests |                    | 2 hours      |
| **Day 3**   | Integration Tests   | tests/integration/ | 4 hours      |
|             | âœ… Full flow test   |                    | 4 hours      |
| **Day 4**   | E2E Tests           | tests/e2e/         | 4 hours      |
|             | âœ… UI workflow test |                    | 4 hours      |
| **Day 5**   | Final Review        | -                  | 4 hours      |
|             | âœ… Code review      |                    | 2 hours      |
|             | âœ… Performance test |                    | 2 hours      |

**Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:**

- âœ… 90%+ test coverage
- âœ… All tests passing
- âœ… Production ready

---

## ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹

### Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª (Current):

| Ø§Ù„Ù…Ù‚ÙŠØ§Ø³                   | Ø§Ù„Ù‚ÙŠÙ…Ø©       |
| ------------------------- | ------------ |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª**           | 6 layers     |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Hooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©** | 2 active     |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Stores**        | 2 (1 unused) |
| **Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**        | 5 sources    |
| **Ø·Ø±Ù‚ Ø§Ù„Ø­ÙØ¸**             | 3 methods    |
| **Bundle Size (pricing)** | ~45 KB       |
| **Lines of Code**         | ~3,500 LOC   |
| **Maintenance Cost**      | High         |
| **Complexity**            | High         |

---

### Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª (Target):

| Ø§Ù„Ù…Ù‚ÙŠØ§Ø³                   | Ø§Ù„Ù‚ÙŠÙ…Ø©     | Ø§Ù„ØªØ­Ø³ÙŠÙ†  |
| ------------------------- | ---------- | -------- |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª**           | 3 layers   | âœ… -50%  |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Hooks Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©** | 0          | âœ… -100% |
| **Ø¹Ø¯Ø¯ Ø§Ù„Ù€ Stores**        | 1          | âœ… -50%  |
| **Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª**        | 1 (Store)  | âœ… -80%  |
| **Ø·Ø±Ù‚ Ø§Ù„Ø­ÙØ¸**             | 1 method   | âœ… -67%  |
| **Bundle Size (pricing)** | ~20 KB     | âœ… -56%  |
| **Lines of Code**         | ~2,000 LOC | âœ… -43%  |
| **Maintenance Cost**      | Low        | âœ… -60%  |
| **Complexity**            | Low        | âœ… -70%  |

---

## ğŸ¯ Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

### Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª:

1. ğŸ”´ **Week 1** - **Ø­Ø±Ø¬Ø©**

   - Ø­Ø°Ù useUnifiedTenderPricing
   - Ø­Ø°Ù useEditableTenderPricing
   - Ù‚Ø±Ø§Ø± pricingWizardStore

2. ğŸŸ¡ **Week 2** - **Ø¹Ø§Ù„ÙŠØ©**

   - ØªÙˆØ­ÙŠØ¯ Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
   - Single Source of Truth

3. ğŸŸ¢ **Week 3** - **Ù…ØªÙˆØ³Ø·Ø©**

   - ØªØ¨Ø³ÙŠØ· Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
   - ØªÙˆØ«ÙŠÙ‚

4. ğŸŸ¢ **Week 4** - **Ù…ØªÙˆØ³Ø·Ø©**
   - Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø´Ø§Ù…Ù„Ø©
   - Ø¬ÙˆØ¯Ø©

---

### Ù†Ù‡Ø¬ Ø§Ù„ØªÙ†ÙÙŠØ°:

**ØªØ¯Ø±ÙŠØ¬ÙŠ** (Incremental) - **Ù…ÙˆØµÙ‰ Ø¨Ù‡**

- âœ… ØªØºÙŠÙŠØ±Ø§Øª ØµØºÙŠØ±Ø©
- âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ ÙƒÙ„ Ø®Ø·ÙˆØ©
- âœ… rollback Ø³Ù‡Ù„
- âœ… Ø£Ù‚Ù„ Ù…Ø®Ø§Ø·Ø±Ø©

**Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù†:**

Big Bang (ÙƒÙ„ Ø´ÙŠØ¡ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©) - **ØºÙŠØ± Ù…ÙˆØµÙ‰ Ø¨Ù‡**

- âŒ ØªØºÙŠÙŠØ±Ø§Øª ÙƒØ¨ÙŠØ±Ø©
- âŒ Ø§Ø®ØªØ¨Ø§Ø± ØµØ¹Ø¨
- âŒ Ù…Ø®Ø§Ø·Ø±Ø© Ø¹Ø§Ù„ÙŠØ©

---

## ğŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©

### Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:

| Ø§Ù„Ø¬Ø§Ù†Ø¨              | Ø§Ù„Ø­Ø§Ù„ÙŠ  | Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù |
| ------------------- | ------- | -------- |
| **Architecture**    | âš ï¸ 6/10 | âœ… 9/10  |
| **Code Quality**    | âš ï¸ 7/10 | âœ… 9/10  |
| **Maintainability** | âš ï¸ 5/10 | âœ… 9/10  |
| **Performance**     | âœ… 8/10 | âœ… 9/10  |
| **Test Coverage**   | âš ï¸ 6/10 | âœ… 9/10  |
| **Documentation**   | âš ï¸ 6/10 | âœ… 9/10  |

### **Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ù…:**

**Ø§Ù„Ø­Ø§Ù„ÙŠ:** âš ï¸ **7/10**
**Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:** âœ… **9/10**

---

### Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©:

**Ø§Ø¨Ø¯Ø£ Ø¨Ù€ Week 1 - Day 1:**

1. âœ… Ø­Ø°Ù `useUnifiedTenderPricing.ts`
2. âœ… ØªØ­Ø¯ÙŠØ« `TenderDetails.tsx`
3. âœ… ØªØ­Ø¯ÙŠØ« `useTenderDetails.ts`
4. âœ… Ø­Ø°Ù `tests/pricing/unifiedTenderPricing.test.ts`
5. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„

**Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù‚Ø¯Ø±:** 4 Ø³Ø§Ø¹Ø§Øª

---

**ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¨ÙˆØ§Ø³Ø·Ø©:** Claude Code Agent
**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 5 Ù†ÙˆÙÙ…Ø¨Ø± 2025
**Ø§Ù„Ù…Ø³ØªÙˆÙ‰:** Ø´Ø§Ù…Ù„ (Comprehensive Analysis)
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 2.0 (Updated & Detailed)

---

## ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø©

- [Zustand Documentation](https://zustand-demo.pmnd.rs/)
- [Repository Pattern](https://martinfowler.com/eaaCatalog/repository.html)
- [React Best Practices](https://react.dev/learn)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
