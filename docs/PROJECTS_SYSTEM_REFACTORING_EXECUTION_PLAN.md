# Ø®Ø·Ø© ØªÙ†ÙÙŠØ° Ø¥Ø¹Ø§Ø¯Ø© Ù‡ÙŠÙƒÙ„Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹

# Projects System Refactoring Execution Plan

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 2025-10-23  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 2.0 (Ù…Ø­Ø¯Ø«Ø©)  
**Branch:** feature/projects-system-quality-improvement  
**Ø§Ù„Ø­Ø§Ù„Ø©:** Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªÙ†ÙÙŠØ°

> ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ ÙˆØ¯Ø±ÙˆØ³ Ù…Ø³ØªÙØ§Ø¯Ø© Ù…Ù† ØªØ¬Ø±Ø¨Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù†Ø§ÙØ³Ø§Øª

---

## ğŸ“‹ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

### Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ

ØªØ­ÙˆÙŠÙ„ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ù† Ù…Ù„ÙØ§Øª Ø¶Ø®Ù…Ø© ØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØµÙŠØ§Ù†Ø© Ø¥Ù„Ù‰ Ù†Ø¸Ø§Ù… Ù…Ø¹ÙŠØ§Ø±ÙŠØŒ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±ØŒ ÙˆØ³Ù‡Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø©.

### Ø§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©

- âœ… ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ù†Ø³Ø¨Ø© 70-87%
- âœ… ØªØ­Ø³ÙŠÙ† Ù‚Ø§Ø¨Ù„ÙŠØ© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ù†Ø³Ø¨Ø© 80%+
- âœ… ØªØ³Ù‡ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØµÙŠØ§Ù†Ø©
- âœ… ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø¨Ù†Ø§Ø¡
- âœ… ØªØ·Ø¨ÙŠÙ‚ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª (Clean Code, SOLID)

### Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©

**14-18 ÙŠÙˆÙ… Ø¹Ù…Ù„** (~3-4 Ø£Ø³Ø§Ø¨ÙŠØ¹)

---

## ğŸ¯ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª ÙˆØ§Ù„Ù…Ø±Ø§Ø­Ù„

### Phase 0: Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

**Ø§Ù„Ù…Ø¯Ø©:** 1 ÙŠÙˆÙ…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Critical ğŸ”´

### Phase 0.5: Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© ÙˆÙ…Ù‚Ø§Ø±Ù†ØªÙ‡Ø§ ğŸ†•

**Ø§Ù„Ù…Ø¯Ø©:** Ù†ØµÙ ÙŠÙˆÙ…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Critical ğŸ”´  
**Ø§Ù„Ø³Ø¨Ø¨:** Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù†Ø§Ù‚ØµØ© (~1,399 Ø³Ø·Ø± Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ~1,500 Ø³Ø·Ø±)

### Phase 1: EnhancedProjectDetails (Ø£ÙƒØ¨Ø± Ù…Ù„Ù)

**Ø§Ù„Ù…Ø¯Ø©:** 3-4 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Critical ğŸ”´

### Phase 2: projectCostService (Ø£ÙƒØ¨Ø± Ø®Ø¯Ù…Ø©)

**Ø§Ù„Ù…Ø¯Ø©:** 2-3 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Critical ğŸ”´

### Phase 3: ProjectsPage

**Ø§Ù„Ù…Ø¯Ø©:** 2-3 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** High ğŸŸ 

### Phase 4: NewProjectForm

**Ø§Ù„Ù…Ø¯Ø©:** 2 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** High ğŸŸ 

### Phase 5: Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©

**Ø§Ù„Ù…Ø¯Ø©:** 2-3 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Medium ğŸŸ¡

### Phase 6: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚

**Ø§Ù„Ù…Ø¯Ø©:** 2-3 Ø£ÙŠØ§Ù…  
**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:** Medium ğŸŸ¡

---

## ğŸ“¦ Phase 0: Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### Ø§Ù„Ù‡Ø¯Ù

Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ¥ØµÙ„Ø§Ø­ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙƒØ³ÙˆØ±Ø©

### Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

#### Task 0.1: Ø¥Ù†Ø´Ø§Ø¡ Branch ÙˆBackup

```powershell
# Ø¥Ù†Ø´Ø§Ø¡ branch Ø¬Ø¯ÙŠØ¯
git checkout -b feature/projects-system-quality-improvement

# Ø¥Ù†Ø´Ø§Ø¡ backup
git checkout -b backup/projects-system-before-refactor-2025-10-23
git checkout feature/projects-system-quality-improvement

# Ø¥Ù†Ø´Ø§Ø¡ tag
git tag projects-refactor-start-2025-10-23
```

**Acceptance Criteria:**

- âœ… Branch Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙ†Ø´Ø·
- âœ… Backup branch Ù…ÙˆØ¬ÙˆØ¯
- âœ… Tag ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡

---

#### Task 0.2: Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…ÙƒØ³ÙˆØ±Ø©

**Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©:**

- `src/presentation/pages/Projects/ProjectsPage.tsx`
- `src/presentation/pages/Projects/components/EnhancedProjectDetails.tsx`
- Ø£ÙŠ Ù…Ù„ÙØ§Øª Ø£Ø®Ø±Ù‰ ØªØ³ØªÙˆØ±Ø¯ Ù…Ù† Ù…Ø³Ø§Ø±Ø§Øª Ù‚Ø¯ÙŠÙ…Ø©

**Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª:**

```typescript
// Ù‚Ø¨Ù„:
import { Clients } from './components/Clients'
import type { Project } from '@/presentation/types/projects'

// Ø¨Ø¹Ø¯:
import { Clients } from '@/presentation/pages/Clients'
import type { Project } from '@/shared/types/projects'
```

**Ø§Ù„Ø£ÙˆØ§Ù…Ø±:**

```powershell
# Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
Select-String -Path src\presentation\pages\Projects\**\*.ts* -Pattern "@/presentation/types/projects" -List

# Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø§Ø­Ø°Ø±!)
Get-ChildItem -Path src\presentation\pages\Projects -Filter *.tsx -Recurse | ForEach-Object {
    (Get-Content $_.FullName) -replace '@/presentation/types/projects', '@/shared/types/projects' | Set-Content $_.FullName
}
```

**Acceptance Criteria:**

- âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙÙŠ `npm run build`
- âœ… Ø¬Ù…ÙŠØ¹ Types Ù…ØªØ§Ø­Ø© ÙˆÙ…Ø³ØªÙˆØ±Ø¯Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- âœ… ESLint ÙŠÙ…Ø± Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡

**Commit Message:**

```
chore(projects): fix import paths and restore type stability

- Update all imports from @/presentation/types/projects to @/shared/types/projects
- Fix Clients component import path
- Ensure build stability before refactoring
```

---

#### Task 0.3: Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£ÙˆÙ„ÙŠ

**Ø§Ù„Ø£ÙˆØ§Ù…Ø±:**

```powershell
# Build
npm run build

# Lint
npm run lint

# Tests
npm run test

# TypeScript Check
npx tsc --noEmit
```

**Acceptance Criteria:**

- âœ… Build ÙŠÙ†Ø¬Ø­ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡
- âœ… Lint ÙŠÙ…Ø± (ÙŠÙ…ÙƒÙ† Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ù€ warnings Ù…Ø¤Ù‚ØªØ©)
- âœ… Tests Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØªÙ…Ø±
- âœ… TypeScript errors = 0

---

## ğŸ“¦ Phase 0.5: Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© ÙˆÙ…Ù‚Ø§Ø±Ù†ØªÙ‡Ø§

### Ø§Ù„Ù‡Ø¯Ù

Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙƒØ§Ù…Ù„Ø© ÙˆØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ù„ØªØ¬Ø²Ø¦Ø©

### Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø§Ù„Ù…ÙƒØªØ´ÙØ©

**Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ:** `src/presentation/pages/Projects/components/EnhancedProjectDetails.tsx`

- **Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:** 1,399 Ø³Ø·Ø±
- **Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (GitHub):** ~1,500 Ø³Ø·Ø±
- **Ø§Ù„ÙØ±Ù‚:** ~100 Ø³Ø·Ø± Ù…ÙÙ‚ÙˆØ¯Ø© âŒ

**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù†Ø§Ù‚ØµØ§Ù‹ Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø£Ùˆ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù

### Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

#### Task 0.5.1: Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ GitHub

**Ø§Ù„Ø£ÙˆØ§Ù…Ø±:**

```powershell
# Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
cd "c:\Users\ammn\Desktop\MBM_app\Final_5Sep\Desktop Management System (Community) (Copy) (Copy)"

# Ù†Ø³Ø® Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
Copy-Item "src\presentation\pages\Projects\components\EnhancedProjectDetails.tsx" `
          "src\presentation\pages\Projects\components\EnhancedProjectDetails.BEFORE_RESTORE.tsx"

Copy-Item "src\presentation\pages\Projects\ProjectsPage.tsx" `
          "src\presentation\pages\Projects\ProjectsPage.BEFORE_RESTORE.tsx"

# Ø¬Ù„Ø¨ Ø¢Ø®Ø± Ù†Ø³Ø®Ø© Ù…Ù† main/my-electron-app
git fetch origin my-electron-app

# Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ù„ÙØ§Øª
git diff origin/my-electron-app:src/components/EnhancedProjectDetails.tsx `
         src/presentation/pages/Projects/components/EnhancedProjectDetails.tsx > comparison_EnhancedProjectDetails.diff

git diff origin/my-electron-app:src/components/Projects.tsx `
         src/presentation/pages/Projects/ProjectsPage.tsx > comparison_ProjectsPage.diff
```

**Acceptance Criteria:**

- âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª backup Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø­Ø§Ù„ÙŠØ©
- âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙØ§Øª diff Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
- âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© Ø¨Ø¯Ù‚Ø©

---

#### Task 0.5.2: ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª

**Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:**

1. ÙØ­Øµ Ù…Ù„ÙØ§Øª Ø§Ù„Ù€ diff Ø§Ù„Ù…ÙÙ†Ø´Ø£Ø©
2. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª/Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©
3. ØªØµÙ†ÙŠÙ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª:
   - âœ… ØªØ­Ø³ÙŠÙ†Ø§Øª ÙŠØ¬Ø¨ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ù‡Ø§
   - âš ï¸ Ù…ÙƒÙˆÙ†Ø§Øª Ù…ÙÙ‚ÙˆØ¯Ø© ÙŠØ¬Ø¨ Ø§Ø³ØªØ¹Ø§Ø¯ØªÙ‡Ø§
   - âŒ ÙƒÙˆØ¯ Ù‚Ø¯ÙŠÙ…/deprecated ÙŠØ¬Ø¨ ØªØ¬Ø§Ù‡Ù„Ù‡

**Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ÙØ­ØµÙ‡Ø§:**

- [ ] SimplifiedProjectCostView integration
- [ ] BOQ synchronization logic
- [ ] Budget comparison features
- [ ] Timeline visualization
- [ ] Purchases table
- [ ] Attachments management
- [ ] Edit/Delete dialogs
- [ ] All tabs (overview, costs, budget, timeline, purchases, attachments)

**Acceptance Criteria:**

- âœ… ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª
- âœ… ØªÙ… ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© ÙˆØ§Ø¶Ø­Ø©
- âœ… ØªÙ… Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø± Ù„ÙƒÙ„ ÙØ±Ù‚ (Ø§Ø³ØªØ¹Ø§Ø¯Ø©/ØªØ¬Ø§Ù‡Ù„)

---

#### Task 0.5.3: Ø§Ø³ØªØ¹Ø§Ø¯Ø©/Ø¯Ù…Ø¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©

**Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:**

```powershell
# Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø³Ø®Ø© Ø¹Ù„Ù‰ GitHub Ø£ÙØ¶Ù„ ÙˆØ£ÙƒØ«Ø± Ø§ÙƒØªÙ…Ø§Ù„Ø§Ù‹:
git checkout origin/my-electron-app -- src/components/EnhancedProjectDetails.tsx
Move-Item src/components/EnhancedProjectDetails.tsx `
          src/presentation/pages/Projects/components/EnhancedProjectDetails.tsx -Force

# Ø£Ùˆ Ø§Ù„Ø¯Ù…Ø¬ Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù„Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙ‚Ø·
# (Ø§Ø³ØªØ®Ø¯Ù… VSCode merge editor)
```

**Ø£Ùˆ Ø§Ù„Ø¯Ù…Ø¬ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ:**

1. ÙØªØ­ Ø§Ù„Ù†Ø³Ø®ØªÙŠÙ† Ø¬Ù†Ø¨Ø§Ù‹ Ø¥Ù„Ù‰ Ø¬Ù†Ø¨ ÙÙŠ VSCode
2. Ù†Ø³Ø® Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹
3. Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø­Ø°Ù Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©

**Acceptance Criteria:**

- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…ÙˆØ¬ÙˆØ¯Ø©
- âœ… Ø§Ù„Ù…Ù„Ù ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡
- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ tabs ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Console

---

#### Task 0.5.4: Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø¯Ø©

**Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:**

```powershell
# Build Test
npm run build

# Lint Test
npm run lint

# Type Check
npx tsc --noEmit

# Manual Tests
# 1. ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹
# 2. ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ù…Ø´Ø±ÙˆØ¹
# 3. Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ tabs (6 tabs)
# 4. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ù„Ø­Ø°Ù
# 5. Ø§Ø®ØªØ¨Ø§Ø± Ø±ÙØ¹ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
# 6. Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ø±Ø¶ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ
```

**Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:**

- [ ] Tab: Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© (Overview) âœ…
- [ ] Tab: Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© (Costs) âœ…
- [ ] Tab: Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© (Budget) âœ…
- [ ] Tab: Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ (Timeline) âœ…
- [ ] Tab: Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© (Purchases) âœ…
- [ ] Tab: Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø±ÙÙ‚Ø§Øª (Attachments) âœ…
- [ ] Dialog: ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ âœ…
- [ ] Dialog: Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ âœ…
- [ ] SimplifiedProjectCostView ÙŠØ¹Ù…Ù„ âœ…
- [ ] BOQ sync ÙŠØ¹Ù…Ù„ âœ…
- [ ] Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØµØ­ÙŠØ­Ø© âœ…

**Acceptance Criteria:**

- âœ… Build ÙŠÙ†Ø¬Ø­
- âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ TypeScript errors
- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ tabs ØªØ¹Ù…Ù„
- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ dialogs ØªØ¹Ù…Ù„
- âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Console
- âœ… Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø§Ù„ÙŠØ© ØªØ­Ø³Ø¨ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­

---

#### Task 0.5.5: Commit Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª

**Commit Message:**

```
fix(projects): restore complete EnhancedProjectDetails with all components

BEFORE:
- EnhancedProjectDetails: 1,399 lines (incomplete)
- Missing components/features identified via GitHub comparison

AFTER:
- EnhancedProjectDetails: ~1,500 lines (complete)
- All tabs functioning: overview, costs, budget, timeline, purchases, attachments
- All dialogs working: edit, delete
- SimplifiedProjectCostView integrated
- BOQ synchronization working
- Budget comparison features restored

FIXES:
- Restored missing components from GitHub version
- Merged improvements from current version
- Ensured all 6 tabs are complete
- Verified all dialogs and features work

TESTING:
- âœ… Build successful
- âœ… All tabs tested and working
- âœ… No TypeScript errors
- âœ… No console errors
- âœ… Financial calculations verified
```

**Ø§Ù„Ø£Ù…Ø±:**

```powershell
git add src/presentation/pages/Projects/components/EnhancedProjectDetails.tsx
git add src/presentation/pages/Projects/components/EnhancedProjectDetails.BEFORE_RESTORE.tsx
git commit -m "fix(projects): restore complete EnhancedProjectDetails with all components"
```

**Acceptance Criteria:**

- âœ… Commit ØªÙ… Ø¨Ù†Ø¬Ø§Ø­
- âœ… Commit message ÙˆØ§Ø¶Ø­ ÙˆÙ…ÙØµÙ„
- âœ… Ø§Ù„Ù€ backup files Ù…Ø­ÙÙˆØ¸Ø©

---

### Phase 0.5 Summary

**Ù…Ø§ ØªÙ…:**

- âœ… Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù…Ø¹ GitHub
- âœ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© (~100 Ø³Ø·Ø±)
- âœ… Ø§Ø³ØªØ¹Ø§Ø¯Ø©/Ø¯Ù…Ø¬ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©
- âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù (6 tabs + 2 dialogs)
- âœ… Commit Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:**

- EnhancedProjectDetails.tsx ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„ØªØ¬Ø²Ø¦Ø©
- ProjectsPage.tsx ÙƒØ§Ù…Ù„ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„ØªØ¬Ø²Ø¦Ø©
- Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡

**Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚:** 2-3 Ø³Ø§Ø¹Ø§Øª

**Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©:** Phase 1 - ØªÙ‚Ø³ÙŠÙ… EnhancedProjectDetails

---

## ğŸ“¦ Phase 1: ØªÙ‚Ø³ÙŠÙ… EnhancedProjectDetails.tsx

### Ø§Ù„Ù‡Ø¯Ù

ØªØ­ÙˆÙŠÙ„ Ù…Ù„Ù 1,502 Ø³Ø·Ø± Ø¥Ù„Ù‰ Ø¨Ù†ÙŠØ© Ù…Ø¹ÙŠØ§Ø±ÙŠØ© Ù…Ù† ~200 Ø³Ø·Ø± Ø±Ø¦ÙŠØ³ÙŠ + Ù…ÙƒÙˆÙ†Ø§Øª ØµØºÙŠØ±Ø©

### Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØ©

```
src/presentation/pages/Projects/details/
â”œâ”€â”€ ProjectDetails.tsx (200 Ø³Ø·Ø±) - Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
â”œâ”€â”€ tabs/
â”‚   â”œâ”€â”€ OverviewTab.tsx (150 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ PurchasesTab.tsx (200 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ CostsTab.tsx (200 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ BudgetTab.tsx (150 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ TimelineTab.tsx (150 Ø³Ø·Ø±)
â”‚   â””â”€â”€ DocumentsTab.tsx (100 Ø³Ø·Ø±)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ProjectHeader.tsx (100 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ ProjectStats.tsx (80 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ BudgetChart.tsx (100 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ PurchaseForm.tsx (150 Ø³Ø·Ø±)
â”‚   â””â”€â”€ CostBreakdown.tsx (120 Ø³Ø·Ø±)
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useProjectDetails.ts (100 Ø³Ø·Ø±)
â”‚   â”œâ”€â”€ useProjectPurchases.ts (100 Ø³Ø·Ø±)
â”‚   â””â”€â”€ useProjectCosts.ts (100 Ø³Ø·Ø±)
â””â”€â”€ types.ts (80 Ø³Ø·Ø±)
```

---

### Task 1.1: Ø¥Ù†Ø´Ø§Ø¡ types.ts

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/types.ts`

**Ø§Ù„Ù…Ø­ØªÙˆÙ‰:**

```typescript
import type { Project } from '@/shared/types/projects'
import type { PurchaseOrder } from '@/shared/types/contracts'
import type { Tender } from '@/data/centralData'

export interface ProjectDetailsProps {
  projectId: string
  onBack: () => void
  onSectionChange?: (section: string) => void
}

export interface EditFormData {
  name: string
  client: string
  description: string
  location: string
  budget: number
  contractValue?: number
  estimatedCost?: number
  expectedProfit?: number
  startDate: string
  endDate: string
  status: 'planning' | 'active' | 'paused' | 'completed' | 'delayed'
  priority: 'low' | 'medium' | 'high' | 'critical'
  progress: number
}

export interface ProjectAttachment {
  id: string
  name: string
  size: number
  mimeType: string
  uploadedAt: string
  contentBase64: string
}

export interface ProjectDetailsContext {
  project: Project | undefined
  relatedTender: Tender | null
  purchaseOrders: PurchaseOrder[]
  attachments: ProjectAttachment[]
  editFormData: EditFormData
  showEditDialog: boolean
  showDeleteDialog: boolean
}
```

**Acceptance Criteria:**

- âœ… Ø§Ù„Ù…Ù„Ù Ù…ÙˆØ¬ÙˆØ¯ ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
- âœ… No TypeScript errors
- âœ… Types Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Ù…Ù„ÙØ§Øª Ø£Ø®Ø±Ù‰

**Commit Message:**

```
refactor(projects): extract types for ProjectDetails

- Create types.ts with all interfaces
- Prepare for component extraction
```

---

### Task 1.2: Ø¥Ù†Ø´Ø§Ø¡ Hooks

#### Hook 1: useProjectDetails.ts

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/hooks/useProjectDetails.ts`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:**

- Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
- Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©
- Ø¬Ù„Ø¨ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
- Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:**

```typescript
import { useState, useEffect } from 'react'
import { useFinancialState } from '@/application/context'
import {
  getTenderRepository,
  getPurchaseOrderRepository,
} from '@/application/services/serviceRegistry'
import { whenStorageReady } from '@/shared/utils/storage/storage'
import type { Project } from '@/shared/types/projects'
import type { Tender } from '@/data/centralData'
import type { PurchaseOrder } from '@/shared/types/contracts'

export function useProjectDetails(projectId: string) {
  const { projects: projectsState } = useFinancialState()
  const { projects } = projectsState

  const [relatedTender, setRelatedTender] = useState<Tender | null>(null)
  const [purchaseOrders, setPurchaseOrders] = useState<PurchaseOrder[]>([])
  const [loading, setLoading] = useState(true)

  const project = projects.find((p) => p.id === projectId)

  useEffect(() => {
    if (!project) {
      setLoading(false)
      return
    }

    let cancelled = false

    const load = async () => {
      try {
        await whenStorageReady()
        const tenderRepo = getTenderRepository()
        const poRepo = getPurchaseOrderRepository()

        const [tender, orders] = await Promise.all([
          typeof tenderRepo.getByProjectId === 'function'
            ? tenderRepo.getByProjectId(project.id)
            : Promise.resolve(null),
          poRepo.getByProjectId(project.id),
        ])

        if (!cancelled) {
          setRelatedTender(tender ?? null)
          setPurchaseOrders(Array.isArray(orders) ? orders : [])
          setLoading(false)
        }
      } catch (error) {
        if (!cancelled) {
          console.warn('Failed to load project details:', error)
          setLoading(false)
        }
      }
    }

    void load()

    return () => {
      cancelled = true
    }
  }, [project])

  return {
    project,
    relatedTender,
    purchaseOrders,
    loading,
  }
}
```

**Acceptance Criteria:**

- âœ… Hook ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- âœ… ÙŠØ¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡
- âœ… ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø­Ø§Ù„Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- âœ… No memory leaks (cleanup ÙÙŠ useEffect)

---

#### Hook 2: useProjectPurchases.ts

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/hooks/useProjectPurchases.ts`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:**

- Ø¥Ø¯Ø§Ø±Ø© Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
- Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ø£Ù…Ø± Ø´Ø±Ø§Ø¡
- Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:**

```typescript
import { useState, useCallback } from 'react'
import { getPurchaseOrderRepository } from '@/application/services/serviceRegistry'
import { toast } from 'sonner'
import type { PurchaseOrder } from '@/shared/types/contracts'

export function useProjectPurchases(projectId: string, initialOrders: PurchaseOrder[] = []) {
  const [orders, setOrders] = useState<PurchaseOrder[]>(initialOrders)
  const [loading, setLoading] = useState(false)

  const addOrder = useCallback(
    async (order: Omit<PurchaseOrder, 'id'>) => {
      setLoading(true)
      try {
        const repo = getPurchaseOrderRepository()
        const newOrder: PurchaseOrder = {
          ...order,
          id: `po-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
          projectId,
        }

        await repo.save(newOrder)
        setOrders((prev) => [...prev, newOrder])
        toast.success('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
        return newOrder
      } catch (error) {
        toast.error('ÙØ´Ù„ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
        throw error
      } finally {
        setLoading(false)
      }
    },
    [projectId],
  )

  const updateOrder = useCallback(
    async (orderId: string, updates: Partial<PurchaseOrder>) => {
      setLoading(true)
      try {
        const repo = getPurchaseOrderRepository()
        const existing = orders.find((o) => o.id === orderId)
        if (!existing) throw new Error('Order not found')

        const updated = { ...existing, ...updates }
        await repo.save(updated)
        setOrders((prev) => prev.map((o) => (o.id === orderId ? updated : o)))
        toast.success('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
      } catch (error) {
        toast.error('ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
        throw error
      } finally {
        setLoading(false)
      }
    },
    [orders],
  )

  const deleteOrder = useCallback(async (orderId: string) => {
    setLoading(true)
    try {
      const repo = getPurchaseOrderRepository()
      await repo.delete(orderId)
      setOrders((prev) => prev.filter((o) => o.id !== orderId))
      toast.success('ØªÙ… Ø­Ø°Ù Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
    } catch (error) {
      toast.error('ÙØ´Ù„ ÙÙŠ Ø­Ø°Ù Ø£Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡')
      throw error
    } finally {
      setLoading(false)
    }
  }, [])

  const totalPurchases = orders.reduce((sum, order) => sum + (order.amount || 0), 0)

  return {
    orders,
    totalPurchases,
    addOrder,
    updateOrder,
    deleteOrder,
    loading,
  }
}
```

---

#### Hook 3: useProjectCosts.ts

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/hooks/useProjectCosts.ts`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:**

- Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ÙØ¹Ù„ÙŠØ©
- Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©
- Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ù†Ø­Ø±Ø§ÙØ§Øª

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:**

```typescript
import { useState, useEffect, useCallback } from 'react'
import { useFinancialState } from '@/application/context'
import { useExpenses } from '@/application/hooks/useExpenses'
import { projectBudgetService } from '@/application/services/projectBudgetService'
import type { ProjectBudgetComparison } from '@/application/services/projectBudgetService'

export function useProjectCosts(projectId: string) {
  const { financial } = useFinancialState()
  const { getExpensesByProject } = useExpenses()
  const { getProjectActualCost } = financial

  const [budgetComparison, setBudgetComparison] = useState<ProjectBudgetComparison[]>([])
  const [budgetSummary, setBudgetSummary] = useState<any>(null)
  const [loading, setLoading] = useState(false)

  const projectExpenses = getExpensesByProject(projectId)
  const actualCost = getProjectActualCost(projectId)

  const refreshBudgetData = useCallback(async () => {
    setLoading(true)
    try {
      const [comparison, summary] = await Promise.all([
        projectBudgetService.getProjectBudgetComparison(projectId),
        projectBudgetService.generateBudgetSummary(projectId),
      ])

      setBudgetComparison(comparison || [])
      setBudgetSummary(summary)
    } catch (error) {
      console.warn('Failed to load budget data:', error)
    } finally {
      setLoading(false)
    }
  }, [projectId])

  useEffect(() => {
    void refreshBudgetData()
  }, [refreshBudgetData])

  return {
    projectExpenses,
    actualCost,
    budgetComparison,
    budgetSummary,
    loading,
    refreshBudgetData,
  }
}
```

**Acceptance Criteria Ù„Ù„Ø¬Ù…ÙŠØ¹:**

- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ hooks ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- âœ… No errors ÙÙŠ Console
- âœ… State management Ø³Ù„ÙŠÙ…
- âœ… Cleanup functions Ù…ÙˆØ¬ÙˆØ¯Ø©

**Commit Message:**

```
refactor(projects): extract custom hooks for ProjectDetails

- Create useProjectDetails for data fetching
- Create useProjectPurchases for purchase management
- Create useProjectCosts for cost calculations
- Prepare for component extraction
```

---

### Task 1.3: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

#### Component 1: ProjectHeader.tsx

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/components/ProjectHeader.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:**

- Ø¹Ø±Ø¶ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ­Ø§Ù„ØªÙ‡
- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­Ø±ÙŠØ± ÙˆØ§Ù„Ø­Ø°Ù
- Badge Ù„Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:**

```typescript
import { Button } from '@/presentation/components/ui/button'
import { Badge } from '@/presentation/components/ui/badge'
import { ArrowRight, Edit, Trash2 } from 'lucide-react'
import type { Project } from '@/shared/types/projects'

interface ProjectHeaderProps {
  project: Project
  onBack: () => void
  onEdit: () => void
  onDelete: () => void
}

const statusLabels: Record<string, string> = {
  planning: 'ØªØ®Ø·ÙŠØ·',
  active: 'Ù†Ø´Ø·',
  paused: 'Ù…ØªÙˆÙ‚Ù',
  completed: 'Ù…ÙƒØªÙ…Ù„',
  delayed: 'Ù…ØªØ£Ø®Ø±'
}

const statusColors: Record<string, string> = {
  planning: 'bg-blue-100 text-blue-800',
  active: 'bg-green-100 text-green-800',
  paused: 'bg-yellow-100 text-yellow-800',
  completed: 'bg-gray-100 text-gray-800',
  delayed: 'bg-red-100 text-red-800'
}

const priorityColors: Record<string, string> = {
  low: 'bg-gray-100 text-gray-800',
  medium: 'bg-blue-100 text-blue-800',
  high: 'bg-orange-100 text-orange-800',
  critical: 'bg-red-100 text-red-800'
}

export function ProjectHeader({ project, onBack, onEdit, onDelete }: ProjectHeaderProps) {
  return (
    <div className="flex items-center justify-between mb-6">
      <div className="flex items-center gap-4">
        <Button variant="ghost" size="icon" onClick={onBack}>
          <ArrowRight className="h-5 w-5" />
        </Button>
        <div>
          <h1 className="text-3xl font-bold">{project.name}</h1>
          <div className="flex gap-2 mt-2">
            <Badge className={statusColors[project.status] || statusColors.active}>
              {statusLabels[project.status] || 'Ù†Ø´Ø·'}
            </Badge>
            <Badge className={priorityColors[project.priority || 'medium']}>
              {project.priority === 'critical' ? 'Ø­Ø±Ø¬' :
               project.priority === 'high' ? 'Ø¹Ø§Ù„ÙŠ' :
               project.priority === 'low' ? 'Ù…Ù†Ø®ÙØ¶' : 'Ù…ØªÙˆØ³Ø·'}
            </Badge>
          </div>
        </div>
      </div>
      <div className="flex gap-2">
        <Button variant="outline" onClick={onEdit}>
          <Edit className="h-4 w-4 ml-2" />
          ØªØ­Ø±ÙŠØ±
        </Button>
        <Button variant="destructive" onClick={onDelete}>
          <Trash2 className="h-4 w-4 ml-2" />
          Ø­Ø°Ù
        </Button>
      </div>
    </div>
  )
}
```

**Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:** ~100 Ø³Ø·Ø±

---

#### Component 2: ProjectStats.tsx

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/components/ProjectStats.tsx`

**Ø§Ù„ÙƒÙˆØ¯:**

```typescript
import { Card, CardContent } from '@/presentation/components/ui/card'
import { DollarSign, TrendingUp, AlertTriangle, Package } from 'lucide-react'
import { formatCurrency } from '@/data/centralData'
import type { Project } from '@/shared/types/projects'

interface ProjectStatsProps {
  project: Project
  actualCost: number
  totalPurchases: number
  variance: number
  variancePercentage: number
}

export function ProjectStats({
  project,
  actualCost,
  totalPurchases,
  variance,
  variancePercentage
}: ProjectStatsProps) {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <Card>
        <CardContent className="p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-sm text-muted-foreground">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</p>
              <p className="text-2xl font-bold">{formatCurrency(project.budget || 0)}</p>
            </div>
            <DollarSign className="h-8 w-8 text-muted-foreground" />
          </div>
        </CardContent>
      </Card>

      <Card>
        <CardContent className="p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-sm text-muted-foreground">Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„ÙØ¹Ù„ÙŠØ©</p>
              <p className="text-2xl font-bold">{formatCurrency(actualCost)}</p>
            </div>
            <TrendingUp className="h-8 w-8 text-muted-foreground" />
          </div>
        </CardContent>
      </Card>

      <Card>
        <CardContent className="p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-sm text-muted-foreground">Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</p>
              <p className="text-2xl font-bold">{formatCurrency(totalPurchases)}</p>
            </div>
            <Package className="h-8 w-8 text-muted-foreground" />
          </div>
        </CardContent>
      </Card>

      <Card>
        <CardContent className="p-6">
          <div className="flex items-center justify-between">
            <div>
              <p className="text-sm text-muted-foreground">Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù</p>
              <p className={`text-2xl font-bold ${variance > 0 ? 'text-red-600' : 'text-green-600'}`}>
                {variancePercentage.toFixed(1)}%
              </p>
            </div>
            <AlertTriangle className={`h-8 w-8 ${variance > 0 ? 'text-red-600' : 'text-green-600'}`} />
          </div>
        </CardContent>
      </Card>
    </div>
  )
}
```

---

### Task 1.4: Ø¥Ù†Ø´Ø§Ø¡ Tabs

#### Tab 1: OverviewTab.tsx

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/tabs/OverviewTab.tsx`

**Ø§Ù„ÙƒÙˆØ¯:**

```typescript
import { Card, CardContent, CardHeader, CardTitle } from '@/presentation/components/ui/card'
import { Progress } from '@/presentation/components/ui/progress'
import { Building2, Calendar, User, MapPin } from 'lucide-react'
import { ProjectStats } from '../components/ProjectStats'
import type { Project } from '@/shared/types/projects'

interface OverviewTabProps {
  project: Project
  actualCost: number
  totalPurchases: number
  formatDateOnly: (date: string) => string
}

export function OverviewTab({ project, actualCost, totalPurchases, formatDateOnly }: OverviewTabProps) {
  const variance = actualCost - (project.budget || 0)
  const variancePercentage = project.budget ? (variance / project.budget) * 100 : 0

  return (
    <div className="space-y-6">
      <ProjectStats
        project={project}
        actualCost={actualCost}
        totalPurchases={totalPurchases}
        variance={variance}
        variancePercentage={variancePercentage}
      />

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <Card>
          <CardHeader>
            <CardTitle>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            <div className="flex items-center gap-3">
              <Building2 className="h-5 w-5 text-muted-foreground" />
              <div>
                <p className="text-sm text-muted-foreground">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</p>
                <p className="font-medium">{project.name}</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <User className="h-5 w-5 text-muted-foreground" />
              <div>
                <p className="text-sm text-muted-foreground">Ø§Ù„Ø¹Ù…ÙŠÙ„</p>
                <p className="font-medium">{project.client || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <MapPin className="h-5 w-5 text-muted-foreground" />
              <div>
                <p className="text-sm text-muted-foreground">Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
                <p className="font-medium">{project.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
              </div>
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            <div className="flex items-center gap-3">
              <Calendar className="h-5 w-5 text-muted-foreground" />
              <div>
                <p className="text-sm text-muted-foreground">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</p>
                <p className="font-medium">{formatDateOnly(project.startDate)}</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <Calendar className="h-5 w-5 text-muted-foreground" />
              <div>
                <p className="text-sm text-muted-foreground">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</p>
                <p className="font-medium">{formatDateOnly(project.endDate)}</p>
              </div>
            </div>
            <div>
              <p className="text-sm text-muted-foreground mb-2">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</p>
              <Progress value={project.progress || 0} className="h-2" />
              <p className="text-sm text-muted-foreground mt-1">{project.progress || 0}%</p>
            </div>
          </CardContent>
        </Card>
      </div>

      {project.description && (
        <Card>
          <CardHeader>
            <CardTitle>Ø§Ù„ÙˆØµÙ</CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-muted-foreground">{project.description}</p>
          </CardContent>
        </Card>
      )}
    </div>
  )
}
```

**Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:** ~150 Ø³Ø·Ø±

---

#### Tabs Ø§Ù„Ø£Ø®Ø±Ù‰ (Ù…Ù„Ø®Øµ)

Ø³Ø£Ù‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ tabs Ø¨Ù†ÙØ³ Ø§Ù„Ù†Ù…Ø·:

**PurchasesTab.tsx** (200 Ø³Ø·Ø±):

- Ø¬Ø¯ÙˆÙ„ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø´Ø±Ø§Ø¡
- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø£Ù…Ø± Ø´Ø±Ø§Ø¡
- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª

**CostsTab.tsx** (200 Ø³Ø·Ø±):

- Ø§Ø³ØªØ®Ø¯Ø§Ù… SimplifiedProjectCostView Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
- Ø¹Ø±Ø¶ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ÙØ¹Ù„ÙŠØ© Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ù…Ø®Ø·Ø·Ø©

**BudgetTab.tsx** (150 Ø³Ø·Ø±):

- Budget comparison
- Variance analysis
- Budget forecast

**TimelineTab.tsx** (150 Ø³Ø·Ø±):

- Ø¹Ø±Ø¶ timeline Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
- Milestones
- Critical path

**DocumentsTab.tsx** (100 Ø³Ø·Ø±):

- Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª
- Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
- ØªÙ†Ø²ÙŠÙ„/Ø­Ø°Ù

---

### Task 1.5: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ProjectDetails.tsx

**Ø§Ù„Ù…Ù„Ù:** `src/presentation/pages/Projects/details/ProjectDetails.tsx`

**Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:** ~200 Ø³Ø·Ø±

**Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:**

```typescript
import { useState } from 'react'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/presentation/components/ui/tabs'
import { PageLayout, EmptyState } from '@/presentation/components/layout/PageLayout'
import { AlertTriangle } from 'lucide-react'

import { ProjectHeader } from './components/ProjectHeader'
import { OverviewTab } from './tabs/OverviewTab'
import { PurchasesTab } from './tabs/PurchasesTab'
import { CostsTab } from './tabs/CostsTab'
import { BudgetTab } from './tabs/BudgetTab'
import { TimelineTab } from './tabs/TimelineTab'
import { DocumentsTab } from './tabs/DocumentsTab'

import { useProjectDetails } from './hooks/useProjectDetails'
import { useProjectPurchases } from './hooks/useProjectPurchases'
import { useProjectCosts } from './hooks/useProjectCosts'

import type { ProjectDetailsProps } from './types'

export function ProjectDetails({ projectId, onBack, onSectionChange }: ProjectDetailsProps) {
  const [activeTab, setActiveTab] = useState('overview')
  const [showEditDialog, setShowEditDialog] = useState(false)
  const [showDeleteDialog, setShowDeleteDialog] = useState(false)

  const { project, relatedTender, purchaseOrders, loading: projectLoading } = useProjectDetails(projectId)
  const { orders, totalPurchases, addOrder, updateOrder, deleteOrder } = useProjectPurchases(projectId, purchaseOrders)
  const { projectExpenses, actualCost, budgetComparison, budgetSummary, refreshBudgetData } = useProjectCosts(projectId)

  // Format helpers
  const formatDateOnly = (date: string) => {
    if (!date) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
    return new Date(date).toLocaleDateString('ar-SA')
  }

  if (!project) {
    return (
      <PageLayout>
        <EmptyState
          icon={AlertTriangle}
          title="Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"
          description="Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨"
        />
      </PageLayout>
    )
  }

  return (
    <PageLayout>
      <ProjectHeader
        project={project}
        onBack={onBack}
        onEdit={() => setShowEditDialog(true)}
        onDelete={() => setShowDeleteDialog(true)}
      />

      <Tabs value={activeTab} onValueChange={(value) => {
        setActiveTab(value)
        onSectionChange?.(value)
      }}>
        <TabsList className="mb-6">
          <TabsTrigger value="overview">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</TabsTrigger>
          <TabsTrigger value="purchases">Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</TabsTrigger>
          <TabsTrigger value="costs">Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</TabsTrigger>
          <TabsTrigger value="budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</TabsTrigger>
          <TabsTrigger value="timeline">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</TabsTrigger>
          <TabsTrigger value="documents">Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</TabsTrigger>
        </TabsList>

        <TabsContent value="overview">
          <OverviewTab
            project={project}
            actualCost={actualCost}
            totalPurchases={totalPurchases}
            formatDateOnly={formatDateOnly}
          />
        </TabsContent>

        <TabsContent value="purchases">
          <PurchasesTab
            projectId={projectId}
            orders={orders}
            addOrder={addOrder}
            updateOrder={updateOrder}
            deleteOrder={deleteOrder}
          />
        </TabsContent>

        <TabsContent value="costs">
          <CostsTab
            projectId={projectId}
            expenses={projectExpenses}
            actualCost={actualCost}
          />
        </TabsContent>

        <TabsContent value="budget">
          <BudgetTab
            project={project}
            budgetComparison={budgetComparison}
            budgetSummary={budgetSummary}
            refreshBudgetData={refreshBudgetData}
          />
        </TabsContent>

        <TabsContent value="timeline">
          <TimelineTab project={project} />
        </TabsContent>

        <TabsContent value="documents">
          <DocumentsTab projectId={projectId} />
        </TabsContent>
      </Tabs>

      {/* Edit & Delete Dialogs */}
    </PageLayout>
  )
}
```

---

### Task 1.6: ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…

**Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:**

1. Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† `EnhancedProjectDetails.tsx`
2. Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ù€:

```typescript
/**
 * @deprecated Use ProjectDetails from ./details/ instead
 * This file is kept for backwards compatibility during migration
 */
export { ProjectDetails as EnhancedProjectDetails } from './details/ProjectDetails'
```

**Acceptance Criteria:**

- âœ… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙŠØ¹Ù…Ù„ Ø¨Ù†ÙØ³ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…
- âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ features Ù…ÙˆØ¬ÙˆØ¯Ø©
- âœ… No regressions
- âœ… Tests ØªÙ…Ø±

**Commit Messages:**

```
refactor(projects): extract ProjectDetails components (1/3)

- Create types, hooks, and ProjectHeader
- Create ProjectStats component
- Prepare structure for tabs

---

refactor(projects): extract ProjectDetails tabs (2/3)

- Create OverviewTab with project info
- Create PurchasesTab with orders management
- Create CostsTab, BudgetTab, TimelineTab, DocumentsTab
- Each tab is now a separate, testable component

---

refactor(projects): complete ProjectDetails refactor (3/3)

- Create main ProjectDetails component
- Update EnhancedProjectDetails to use new structure
- Reduce from 1,502 to ~200 lines in main file
- Total reduction: ~1,300 lines (-87%)
```

---

**Phase 1 Summary:**

- **Input:** 1 Ù…Ù„Ù Ã— 1,502 Ø³Ø·Ø± = 1,502 Ø³Ø·Ø±
- **Output:** 1 Ù…Ù„Ù Ø±Ø¦ÙŠØ³ÙŠ (200 Ø³Ø·Ø±) + 16 Ù…Ù„Ù ÙØ±Ø¹ÙŠ (~1,200 Ø³Ø·Ø±) = ~1,400 Ø³Ø·Ø±
- **Ø§Ù„ØªÙˆÙÙŠØ±:** ~100 Ø³Ø·Ø± (7%) + ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù‚Ø§Ø¨Ù„ÙŠØ© Ù„Ù„ØµÙŠØ§Ù†Ø© Ø¨Ù†Ø³Ø¨Ø© 400%

---

## ğŸ“¦ Phase 2: ØªÙ‚Ø³ÙŠÙ… projectCostService.ts

Ø³Ø£ÙˆÙØ± Ø®Ø·Ø© ØªÙØµÙŠÙ„ÙŠØ© Ù…Ø´Ø§Ø¨Ù‡Ø© Ù„Ù„Ù€ Phase 2-6 ÙÙŠ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©...

**Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¹Ø§Ù…Ø©:**

- âœ… Build ÙŠÙ†Ø¬Ø­ Ø¨Ø¹Ø¯ ÙƒÙ„ commit
- âœ… Tests ØªÙ…Ø±
- âœ… No TypeScript errors
- âœ… Code quality Ù…Ø­Ø³Ù‘Ù†
- âœ… Documentation Ù…Ø­Ø¯Ø«Ø©

---

**Next Steps:**

1. Ø¨Ø¯Ø¡ ØªÙ†ÙÙŠØ° Phase 0
2. Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬
3. Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Phase 1

Ù‡Ù„ ØªØ±ÙŠØ¯ Ø£Ù† Ø£ÙƒÙ…Ù„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (Phase 2-6) Ø¨Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù…Ù† Ø§Ù„ØªÙØµÙŠÙ„ØŸ
