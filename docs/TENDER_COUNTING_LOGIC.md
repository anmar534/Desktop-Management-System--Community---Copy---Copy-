# Tender Counting Logic - ููุทู ุญุณุงุจ ุงูููุงูุณุงุช

## ๐ Overview

ูุฐุง ุงููุณุชูุฏ ูุดุฑุญ ุงูููุทู ุงูููุญุฏ ูุญุณุงุจ ุงูููุงูุณุงุช ูุนุฑุถูุง ูู ุงูุนุฏุงุฏุงุช ูุงูุชุจููุจุงุช.

## ๐ฏ ุงููุงุนุฏุฉ ุงูุฃุณุงุณูุฉ

**ุงูููุงูุณุฉ ุชูุนุชุจุฑ ููุชููุฉ ููุท ุฅุฐุง:**

1. โ ุงูุชูู ููุนุฏ ุชูุฏูููุง **AND**
2. โ ูู ูุชู ุฅุฑุณุงููุง (status โ 'submitted', 'won', 'lost')

**โ๏ธ ูุงุนุฏุฉ ูููุฉ:**

- ุงูููุงูุณุงุช ุงูููุฑุณูุฉ (submitted) ุชุชุญูู ุฅูู "ุจุงูุชุธุงุฑ ุงููุชุงุฆุฌ" **ุจุบุถ ุงููุธุฑ** ุนู ููุนุฏ ุงูุชูุงุฆูุง
- ุงูููุงูุณุงุช ุงููุงุฆุฒุฉ/ุงูุฎุงุณุฑุฉ (won/lost) ูุง ุชูุนุชุจุฑ ููุชููุฉ ุฃุจุฏุงู

## ๐ข ุขููุฉ ุงูุญุณุงุจ

### 1. ุชุตููู ุงูููุงูุณุงุช

ุงูููุงูุณุงุช ุชูุตูู ุฅูู 3 ูุฆุงุช ุฑุฆูุณูุฉ:

#### ุฃ) ุงูููุงูุณุงุช ุงูููุชููุฉ (Expired)

```typescript
const expired = isTenderExpired(tender)
// ุงูููุงูุณุฉ ููุชููุฉ ุฅุฐุง:
// 1. status = 'expired' OR 'cancelled' (ุฅูุบุงุก ุตุฑูุญ)
// 2. ุงูุชูู ุงูููุนุฏ ุงูููุงุฆู AND status = 'new', 'under_action', 'ready_to_submit'
//
// โ๏ธ ุงูููุงูุณุงุช ุงููุฑุณูุฉ ูุง ุชุนุชุจุฑ ููุชููุฉ:
// status = 'submitted', 'won', 'lost' โ expired = false
```

#### ุจ) ุงูููุงูุณุงุช ุงูููุชููุฉ (Won/Lost)

```typescript
status === 'won' || status === 'lost'
// ุงูููุงูุณุงุช ุงูุชู ููุง ูุชูุฌุฉ ููุงุฆูุฉ
// ุชุธูุฑ ููุท ูู ุชุจููุจุงุช "ูุงุฆุฒ" ุฃู "ุฎุงุณุฑ"
// ูุง ุชูุนุชุจุฑ ููุชููุฉ ุญุชู ูู ุงูุชูู ุงูููุนุฏ
```

#### ุฌ) ุงูููุงูุณุงุช ุงููุดุทุฉ (Active)

```typescript
!expired && status !== 'won' && status !== 'lost'
// ุงูููุงูุณุงุช ููุฏ ุงูุนูู
// ุชุดูู: new, under_action, ready_to_submit, submitted
// ุชุธูุฑ ูู ุงูุชุจููุจุงุช ุงููุดุทุฉ (ุงูููุ ุฌุฏูุฏุ ุชุญุช ุงูุฅุฌุฑุงุกุ ุจุงูุชุธุงุฑ ุงููุชุงุฆุฌ)
```

### 2. ุงูุนุฏุงุฏุงุช ูู StatusBadge

| ุงูุนุฏุงุฏ              | ุงููููุฉ                        | ุงููุตู                                                           |
| ------------------- | ----------------------------- | --------------------------------------------------------------- |
| **ุงููู**            | `total`                       | ุนุฏุฏ ุงูููุงูุณุงุช ุงููุดุทุฉ ููุท (ุจุฏูู ููุชููุฉ/ูุงุฆุฒ/ุฎุงุณุฑ)                |
| **ุนุงุฌู**            | `urgent`                      | ุงูููุงูุณุงุช ุงููุดุทุฉ ุงูุชู ููุนุฏูุง ุงูููุงุฆู ุฎูุงู 7 ุฃูุงู                |
| **ุฌุฏูุฏ**            | `new`                         | ุงูููุงูุณุงุช ุจุญุงูุฉ 'new' ูุบูุฑ ููุชููุฉ                               |
| **ุชุญุช ุงูุฅุฌุฑุงุก**     | `underAction + readyToSubmit` | ุงูููุงูุณุงุช ุจุญุงูุฉ 'under_action' ุฃู 'ready_to_submit' ูุบูุฑ ููุชููุฉ |
| **ุจุงูุชุธุงุฑ ุงููุชุงุฆุฌ** | `waitingResults`              | ุงูููุงูุณุงุช ุจุญุงูุฉ 'submitted' (ุจุบุถ ุงููุธุฑ ุนู ุงูููุนุฏ)               |
| **ูุงุฆุฒ**            | `won`                         | ุงูููุงูุณุงุช ุงููุงุฆุฒุฉ (ุจุบุถ ุงููุธุฑ ุนู ุงูููุนุฏ)                         |
| **ุฎุงุณุฑ**            | `lost`                        | ุงูููุงูุณุงุช ุงูุฎุงุณุฑุฉ (ุจุบุถ ุงููุธุฑ ุนู ุงูููุนุฏ)                         |
| **ููุชููุฉ**          | `expired`                     | ุงูููุงูุณุงุช ุงูุชู ุงูุชูู ููุนุฏูุง ููู ูุชู ุฅุฑุณุงููุง                     |

### 3. ููุทู ุงูุญุณุงุจ ูู tenderSummaryCalculator.ts

```typescript
for (const tender of tenders) {
  const expired = isTenderExpired(tender)

  // 1. ุฅุฐุง ููุชููุฉ โ ุงุญุณุจูุง ูู expired ููุท ูุชููู
  if (expired) {
    expiredCount += 1
    continue
  }

  // 2. ุฅุฐุง ูุงุฆุฒุฉ/ุฎุงุณุฑุฉ โ ุงุญุณุจูุง ูู won/lost ููุท ูุชููู
  if (status === 'won') {
    wonCount += 1
    continue
  }
  if (status === 'lost') {
    lostCount += 1
    continue
  }

  // 3. ุงูุขู ุงุญุณุจ ุงูููุงูุณุงุช ุงููุดุทุฉ ููุท
  activeNonExpiredCount += 1

  switch (status) {
    case 'new':
      newCount += 1
      break
    case 'under_action':
      underActionCount += 1
      break
    case 'ready_to_submit':
      readyToSubmitCount += 1
      break
    case 'submitted':
      waitingResultsCount += 1
      break
  }

  // ุญุณุงุจ ุงูุนุงุฌูุฉ (ููุท ูู ุงููุดุทุฉ)
  if (isUrgent(tender)) {
    urgent += 1
  }
}

return {
  total: activeNonExpiredCount, // โ๏ธ ููู: ุงูุนุฏุงุฏ ุงูููู = ุงููุดุทุฉ ููุท
  urgent,
  new: newCount,
  // ... ุจุงูู ุงูุนุฏุงุฏุงุช
}
```

### 4. ููุทู ุงูููุชุฑุฉ ูู matchesTabFilter

```typescript
function matchesTabFilter(tender: Tender, tab: TenderTabId): boolean {
  const expired = isTenderExpired(tender)

  switch (tab) {
    case 'all':
      return !expired && status !== 'won' && status !== 'lost'

    case 'urgent':
      return !expired && isUrgent(tender)

    case 'new':
      return status === 'new' && !expired

    case 'under_action':
      return (status === 'under_action' || status === 'ready_to_submit') && !expired

    case 'waiting_results':
      return status === 'submitted' && !expired

    case 'won':
      return status === 'won' // ูุง ููู ุงูููุนุฏ

    case 'lost':
      return status === 'lost' // ูุง ููู ุงูููุนุฏ

    case 'expired':
      return expired
  }
}
```

## โ ุงูุชูุงูู ุจูู ุงูุนุฏุงุฏุงุช ูุงูููุงุชุฑ

| ุงูุชุจููุจ         | ุงูุนุฏุงุฏ                          | ุงูููุชุฑ                                            | โ ูุชุทุงุจู |
| --------------- | ------------------------------- | ------------------------------------------------- | -------- |
| ุงููู            | `total = activeNonExpiredCount` | `!expired && !won && !lost`                       | โ       |
| ุนุงุฌู            | `urgent` (from active only)     | `!expired && isUrgent`                            | โ       |
| ุฌุฏูุฏ            | `new` (from active only)        | `status === 'new' && !expired`                    | โ       |
| ุชุญุช ุงูุฅุฌุฑุงุก     | `underAction + readyToSubmit`   | `(under_action \|\| ready_to_submit) && !expired` | โ       |
| ุจุงูุชุธุงุฑ ุงููุชุงุฆุฌ | `waitingResults`                | `status === 'submitted' && !expired`              | โ       |
| ูุงุฆุฒ            | `won` (separate count)          | `status === 'won'`                                | โ       |
| ุฎุงุณุฑ            | `lost` (separate count)         | `status === 'lost'`                               | โ       |
| ููุชููุฉ          | `expired`                       | `isTenderExpired(tender)`                         | โ       |

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ููุงูุณุฉ ููุชููุฉ ูุน status='new'

```typescript
tender = { status: 'new', deadline: '2025-10-20' } // past deadline
expired = true

// ุงูุนุฏุงุฏุงุช:
expiredCount += 1
newCount += 0 // โ ูุง ุชูุญุณุจ ูู ุงูุฌุฏูุฏุฉ
total += 0 // โ ูุง ุชูุญุณุจ ูู ุงููู

// ุงูููุงุชุฑ:
matchesTabFilter(tender, 'new') = false // โ ูุง ุชุธูุฑ
matchesTabFilter(tender, 'all') = false // โ ูุง ุชุธูุฑ
matchesTabFilter(tender, 'expired') = true // โ ุชุธูุฑ
```

### ูุซุงู 2: ููุงูุณุฉ ุนุงุฌูุฉ ูุดุทุฉ

```typescript
tender = { status: 'under_action', deadline: '2025-10-28' } // 3 days remaining
expired = false

// ุงูุนุฏุงุฏุงุช:
underActionCount += 1 // โ
urgent += 1 // โ (ููุนุฏ ุฎูุงู 7 ุฃูุงู)
total += 1 // โ

// ุงูููุงุชุฑ:
matchesTabFilter(tender, 'under_action') = true // โ
matchesTabFilter(tender, 'urgent') = true // โ
matchesTabFilter(tender, 'all') = true // โ
```

### ูุซุงู 3: ููุงูุณุฉ ูุงุฆุฒุฉ (ููุชููุฉ ุงูููุนุฏ)

```typescript
tender = { status: 'won', deadline: '2025-10-20' }
expired = true(technically)

// ุงูุนุฏุงุฏุงุช:
wonCount += 1 // โ ุชูุญุณุจ ูู ุงููุงุฆุฒุฉ
total += 0 // โ ูุง ุชูุญุณุจ ูู ุงููู

// ุงูููุงุชุฑ:
matchesTabFilter(tender, 'won') = true // โ
matchesTabFilter(tender, 'all') = false // โ
matchesTabFilter(tender, 'expired') = false // โ (ุงููุงุฆุฒุฉ ููุง ุชุจููุจ ุฎุงุต)
```

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃููููุฉ ูู ุงูุชุตููู:**

   - ุงูููุชููุฉ ุฃููุงู โ ูุง ุชูุญุณุจ ูู ุฃู ุนุฏุงุฏ ุขุฎุฑ
   - ุงููุงุฆุฒุฉ/ุงูุฎุงุณุฑุฉ ุซุงููุงู โ ููุง ุชุจููุจุงุช ุฎุงุตุฉ
   - ุงููุดุทุฉ ุฃุฎูุฑุงู โ ุชูุญุณุจ ูู ุจุงูู ุงูุชุจููุจุงุช

2. **ุงูุนุฏุงุฏ "ุงููู":**

   - ูุง ูุนูู "ุฌููุน ุงูููุงูุณุงุช"
   - ูุนูู "ุฌููุน ุงูููุงูุณุงุช ุงููุดุทุฉ"
   - ูุณุชุจุนุฏ: ุงูููุชููุฉุ ุงููุงุฆุฒุฉุ ุงูุฎุงุณุฑุฉ

3. **ุงูููุงูุณุงุช ุงูุนุงุฌูุฉ:**
   - ูุฌุจ ุฃู ุชููู ูุดุทุฉ (ุบูุฑ ููุชููุฉ)
   - ุงูููุนุฏ ุงูููุงุฆู ุฎูุงู 7 ุฃูุงู ุฃู ุฃูู
   - ุงูุญุงูุฉ ุถูู: new, under_action, ready_to_submit

## ๐๏ธ ุงููููุงุช ุงููุชุฃุซุฑุฉ

| ุงูููู                        | ุงููุณุคูููุฉ                   |
| ---------------------------- | --------------------------- |
| `tenderSummaryCalculator.ts` | ุญุณุงุจ ุงูุนุฏุงุฏุงุช               |
| `tenderFilters.ts`           | ููุชุฑุฉ ุงูููุงูุณุงุช ุญุณุจ ุงูุชุจููุจ |
| `tenderTabHelpers.ts`        | ุฑุจุท ุงูุนุฏุงุฏุงุช ุจุงูุชุจููุจุงุช     |
| `TendersPage.tsx`            | ุนุฑุถ ุงูุนุฏุงุฏุงุช ูุงูุชุจููุจุงุช     |

## โจ ุงูุชุญุณููุงุช ุงููููุฐุฉ

- โ ุชูุญูุฏ ุงูููุทู ุจูู ุงูุญุณุงุจ ูุงูููุชุฑุฉ
- โ ุฅุฒุงูุฉ ุงูุชุนุงุฑุถ ุจูู ุงูุนุฏุงุฏุงุช ูุงููุญุชูู ุงููุนุฑูุถ
- โ ูุตู ุงูููุงูุณุงุช ุงูููุชููุฉ/ุงููุงุฆุฒุฉ/ุงูุฎุงุณุฑุฉ ุนู ุงููุดุทุฉ
- โ ุญุณุงุจ ุฏููู ููููุงูุณุงุช ุงูุนุงุฌูุฉ
- โ ุนุฏุงุฏุงุช ูุชุทุงุจูุฉ 100% ูุน ุงูููุงุชุฑ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 25 ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** v1.0.0
